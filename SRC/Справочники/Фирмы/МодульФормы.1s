////////////////////////////////////////////////////////////////////////////////
// ѕ≈–≈ћ≈ЌЌџ≈ ћќƒ”Ћя
// 
ѕерем ёрјдрес, ‘актјдрес, јдрес»ћЌ—; // јдреса юр. лица и »ћЌ—.
ѕерем ¬ирт–еквизитыѕлательщика»лиѕолучател€;

////////////////////////////////////////////////////////////////////////////////
// ѕ–ќ÷≈ƒ”–џ » ‘”Ќ ÷»» ћќƒ”Ћя
// 
//******************************************************************************
// —формировать–еквизит(–еквизит‘ормы, Ёлементƒиалога)
//
// ѕараметры:
//  –еквизит‘ормы     - строка Ц значение реквизита в диалоге формы.
//  Ёлементƒиалога    - строка Ц идентификатор редактируемго элемента диалога.
//
// ¬ызываетс€ из формул элементов диалога:
//
// ќписание:
// ѕроцедура устанавливает доступность редактировани€ реквизита 
// "ѕолучатель". ≈сли реквизит недоступен, данные  
// пол€ заполн€ютс€ стандартным представлением.
//
ѕроцедура —формировать–еквизит(–еквизит‘ормы, Ёлементƒиалога)
	
	≈сли ѕуста€—трока(¬ирт–еквизитыѕлательщика»лиѕолучател€) = 1 “огда

		//заполн€ем стандартным представлением		
		–еквизит‘ормы = "";

		ѕараметры = —оздатьќбъект("—писок«начений");
		ѕараметры.ƒобавить«начение(—окрЋѕ(»ЌЌ),"»ЌЌ");
		ѕараметры.ƒобавить«начение(?(ѕуста€—трока(ѕолнЌаименование)=1,ЌаименованиеёрЋица,ѕолнЌаименование),"Ќаименование онтрагента");
		ѕараметры.ƒобавить«начение(—окрЋѕ(Ќомер—чета),"Ќомер—чета");
		ѕараметры.ƒобавить«начение(Ѕанк,"Ѕанк");
		ѕараметры.ƒобавить«начение(Ѕанкƒл€–асчетов,"Ѕанкƒл€–асчетов");

		гл–еквизитыѕлательщикаѕолучател€(ѕараметры);

		–еквизит‘ормы = ѕараметры.ѕолучить("–езультат");
		
		‘орма.ѕолучитьјтрибут(Ёлементƒиалога).ƒоступность(0);

	»наче
		
		–еквизит‘ормы = ¬ирт–еквизитыѕлательщика»лиѕолучател€;
		‘орма.ѕолучитьјтрибут(Ёлементƒиалога).ƒоступность(1);
		
	 онец≈сли;
	
 онецѕроцедуры // —формировать–еквизит()

//******************************************************************************
// ѕри»зменении¬алюты()
//
// ѕараметры:
//
// ¬озвращаемое значение:
//  Ќет.
//
// ¬ызываетс€ из формул элементов диалога:
//  ¬алюта—чета.
//
// ќписание:
//  ќбновл€ет реквизиты диалога при изменении валюты счета.
//
ѕроцедура ѕри»зменении¬алюты()
	
	≈сли (¬алюта—чета = гл–убли) »Ћ» (¬алюта—чета.¬ыбран() = 0) “огда
		‘орма.“екст¬ид—чета.«аголовок("¬ид счета (расчетный и т. д.):");
		¬ид—четаЌомер–азрешени€ = ќсновной—чет.¬ид—чета;
	»наче
		‘орма.“екст¬ид—чета.«аголовок("Ќомер и дата разрешени€ ÷Ѕ:");
		¬ид—четаЌомер–азрешени€ = ќсновной—чет.Ќомер»ƒата–азрешени€;
	 онец≈сли;
	
 онецѕроцедуры // ѕри»зменении¬алюты()

//******************************************************************************
// ѕри»змененииќсн—чета()
//
// ѕараметры:
//
// ¬озвращаемое значение:
//  Ќет.
//
// ¬ызываетс€ из формул элементов диалога:
//
// ќписание:
//  ќбновл€ет реквизиты диалога при изменении основного счета.
//
ѕроцедура ѕри»змененииќсн—чета()
	
	// ѕроверка соответсви€ основного счета юр. лицу.
	≈сли ќсновной—чет.ёр‘изЋицо <> ёрЋицо “огда
		ќсновной—чет = ѕолучитьѕустое«начение("—правочник.Ѕанковские—чета");
	 онец≈сли;

	// «аполнение реквизитов сло€ "ќсновной—чет".
	Ќаименованиеќсн—чета = ќсновной—чет.Ќаименование;
	Ѕанк                 = ќсновной—чет.Ѕанк;
	Ѕанкƒл€–асчетов      = ќсновной—чет.Ѕанкƒл€–асчетов;
	Ќомер—чета           = ќсновной—чет.Ќомер—чета;
	¬алюта—чета          = ќсновной—чет.¬алюта—чета;
	ƒатаќткрыти€—чета    = ќсновной—чет.ƒатаќткрыти€—чета;
	ƒата«акрыти€—чета    = ќсновной—чет.ƒата«акрыти€—чета;
	—уммаЅез00 опеек     = ќсновной—чет.—уммаЅез00 опеек;
	ћес€цѕрописью        = ќсновной—чет.ћес€цѕрописью;
	¬ирт–еквизитыѕлательщика»лиѕолучател€ = ќсновной—чет.–еквизитыѕлательщика»лиѕолучател€;
 	
	—формировать–еквизит(ѕлательщикѕолучатель, "ѕлательщикѕолучатель");
 
	ѕри»зменении¬алюты();
	
 онецѕроцедуры // ѕри»змененииќсн—чета()

//******************************************************************************
// ѕри»зменении“екущейƒаты()
//
// ѕараметры:
//
// ¬озвращаемое значение:
//  Ќет.
//
// ¬ызываетс€ из формул элементов диалога:
//
// ќписание:
//  ќбновл€ет периодические реквизиты диалога.
//
ѕроцедура ѕри»зменении“екущейƒаты()
	
	“екƒата = »спользоватьƒату();
	
	‘орма.«аголовок("("+“екƒата+")", 1);
	
	// «аполнение реквизитов сло€ "ƒолжностныеЋица".
	–уководитель                = ёрЋицо.–уководитель.ѕолучить(“екƒата);
	√лЅухгалтер                 = ёрЋицо.√лЅухгалтер.ѕолучить(“екƒата);
	 ассир                      = ёрЋицо. ассир.ѕолучить(“екƒата);
	
	// «аполнение реквизитов сло€ "”четна€ѕолитика".
	ћетодыќпределени€¬ыручки1   = ёрЋицо.ћетодќпределени€¬ыручки.ѕолучить(“екƒата).ѕор€дковыйЌомер();
	ћетоды–асчета—ебестоимости1 = ёрЋицо.ћетод–асчета—ебестоимости.ѕолучить(“екƒата).ѕор€дковыйЌомер();
	ћетоды”чета–озницы1 		= ёрЋицо.ћетод”чета–озницы.ѕор€дковыйЌомер();
	—тавкаЌѕсјванса             = ёрЋицо.—тавкаЌѕсјванса.ѕолучить(“екƒата);
	
 онецѕроцедуры // ѕри»зменении“екущейƒаты()

//******************************************************************************
// ѕри»змененииёрЋица()
//
// ѕараметры:
//
// ¬озвращаемое значение:
//  Ќет.
//
// ¬ызываетс€ из формул элементов диалога:
//
// ќписание:
//  ќбновл€ет реквизиты диалога при изменении юридического лица.
//
ѕроцедура ѕри»змененииёрЋица()
	
	// —троки неограниченной длины надо очищать тщательнее!
	
	// «аполнение реквизитов сло€ "ёрЋицо".
	ЌаименованиеёрЋица       = ёрЋицо.Ќаименование;
	ѕрефиксЌомеровƒокументов = ёрЋицо.ѕрефиксЌомеровƒокументов;
	ѕолнЌаименование         = ёрЋицо.“екущийЁлемент().ѕолнЌаименование;
	»ЌЌ                      = ёрЋицо.»ЌЌ;
	“елефоны                 = ёрЋицо.“екущийЁлемент().“елефоны;
	ёрјдрес                  = ёрЋицо.“екущийЁлемент().ёрјдрес;
	‘актјдрес                = ёрЋицо.“екущийЁлемент().‘актјдрес;
	
	// «аполнение реквизитов сло€ "ёрЋицоƒоп".
	‘орма—обственности       = ёрЋицо.“екущийЁлемент().‘орма—обственности;
	ƒата–егистрации          = ёрЋицо.ƒата–егистрации;
	ќргѕрав‘орма             = ёрЋицо.“екущийЁлемент().ќргѕрав‘орма;
	ќфициальноеЌаименование  = ёрЋицо.“екущийЁлемент().ќфициальноеЌаименование;
	ќ ѕќ                     = ёрЋицо.ќ ѕќ;
	ќ ƒѕ                     = ёрЋицо.ќ ƒѕ;
	ќ ќЌ’                    = ёрЋицо.ќ ќЌ’;
	ќ ќѕ‘                    = ёрЋицо.ќ ќѕ‘;
	ќ ‘—                     = ёрЋицо.ќ ‘—;
	ќсновной¬идƒе€тельности  = ёрЋицо.“екущийЁлемент().ќсновной¬идƒе€тельности;
	ЌомерЋиста ассовой ниги  = ёрЋицо.ЌомерЋиста ассовой ниги.ѕолучить(»спользоватьƒату());
	
	// «аполнение реквизитов сло€ "ƒолжностныеЋица".
	ƒолжность–уководител€    = ёрЋицо.“екущийЁлемент().ƒолжность–уководител€;
	Ќаименование»ћЌ—         = ёрЋицо.“екущийЁлемент().Ќаименование»ћЌ—;
	 од»ћЌ—                  = ёрЋицо. од»ћЌ—;
	јдрес»ћЌ—                = ёрЋицо.“екущийЁлемент().јдрес»ћЌ—;
	
	// «аполнение сло€ "”четна€ѕолитика"
	”читыватьЌƒ—             = ёрЋицо.”читыватьЌƒ—;
	”читыватьЌѕ              = ёрЋицо.”читыватьЌѕ;
	
	ѕри»зменении“екущейƒаты();
	
	// ѕроверка соответсви€ основного счета юр. лицу.
	≈сли ќсновной—чет.ёр‘изЋицо <> ёрЋицо “огда
		ѕри»змененииќсн—чета();
	 онец≈сли;

 онецѕроцедуры // ѕри»змененииёрЋица()

//******************************************************************************
// ѕри»зменении”прјналитики()
//
// ѕараметры:
//
// ¬озвращаемое значение:
//  Ќет.
//
// ¬ызываетс€ из формул элементов диалога:
//
// ќписание:
//  ќбновл€ет реквизиты диалога при изменении упр. аналитики.
//
ѕроцедура ѕри»зменении”прјналитики()
	
	// «аполнение реквизитов сло€ "”прјналитика".
	Ќаименование”прјналитики = ”прјналитика.Ќаименование;

 онецѕроцедуры // ѕри»зменении”прјналитики()

//******************************************************************************
// Ќужно«аписатьЁлемент(ќбъект)
//
// ѕараметры:
//  ќбъект - объект, созданный методом "—оздатьќбъект()".
//
// ¬озвращаемое значение:
//  1 - объект нужно записывать.
//  0 - объект не нужно записывать.
//
// ¬ызываетс€ из формул элементов диалога:
//
// ќписание:
//  ѕровер€ет необходимость записи объекта.
//
‘ункци€ Ќужно«аписатьЁлемент(ќбъект)
	
	// ќбъект может записыватьс€ впервые.
	≈сли ѕустое«начение(ќбъект.“екущийЁлемент()) = 1 “огда
		¬озврат 1;
	 онец≈сли;
	
	// “екущее значение атрибута может отличаеттс€ от записанного.
	≈сли ќбъект.Ќаименование <> ќбъект.“екущийЁлемент().Ќаименование “огда
		¬озврат 1;
	 онец≈сли;
	
	// ѕроверка значений реквизитов объекта.
	мд—правочник = ћетаданные.—правочник(ќбъект.¬ид());
	ƒл€ Ќомер = 1 ѕо мд—правочник.–еквизит() ÷икл
		
		// ѕериодические реквизиты не сравниваютс€.
		≈сли мд—правочник.–еквизит(Ќомер).ѕериодический = 1 “огда
			ѕродолжить;
		 онец≈сли;
		
		»д = мд—правочник.–еквизит(Ќомер).»дентификатор;
		// “екущее значение атрибута может отличаеттс€ от записанного.
		≈сли ќбъект.ѕолучитьјтрибут(»д) <> ќбъект.“екущийЁлемент().ѕолучитьјтрибут(»д) “огда
			¬озврат 1;
		 онец≈сли;
	 онец÷икла;
	
	¬озврат 0;
	
 онец‘ункции // Ќужно«аписатьЁлемент()

//******************************************************************************
// ћожно«аписатьЁлемент(ќбъект)
//
// ѕараметры:
//  ќбъект - объект, созданный методом "—оздатьќбъект()".
//
// ¬озвращаемое значение:
//  1 - объект можно записывать.
//  0 - объект нельз€ записывать.
//
// ¬ызываетс€ из формул элементов диалога:
//
// ќписание:
//  ѕровер€ет возможность записи объекта.
//
‘ункци€ ћожно«аписатьЁлемент(ќбъект)
	
	≈сли      ќбъект.¬ыбран() = 0 “огда
		¬озврат 1;

	»наче≈сли ќбъект.Ѕлокировка(1) = 1 “огда
		¬озврат 1;
	
	»наче
		Ёлемент = ќбъект.“екущийЁлемент();

		—тр = 
		"Ёлемент справочника """+Ёлемент.ѕредставление¬ида()+""": ("+
		Ёлемент. од+") """+Ёлемент.Ќаименование+""" заблокирован!";
		ѕредупреждение(—тр, 60);
		
		¬озврат 0;
	 онец≈сли;
	
 онец‘ункции // ћожно«аписатьЁлемент()

//******************************************************************************
// «аписьёрЋица()
//
// ѕараметры:
//
// ¬озвращаемое значение:
//  1 - запись произведена.
//  0 - запись не произведена.
//
// ¬ызываетс€ из формул элементов диалога:
//
// ќписание:
//  ќсуществл€ет запись юр. лица.
//
‘ункци€ «аписьёрЋица()
	
	// ќбъект дл€ записи юр. лица.
	ќбъект = —оздатьќбъект("—правочник.—воиёрЋица");
	≈сли ќбъект.ЌайтиЁлемент(ёрЋицо) = 0 “огда
		ќбъект.Ќовый();
	 онец≈сли;
	
	// «аполнение реквизитов сло€ "ёрЋицо".
	ќбъект.Ќаименование             = ЌаименованиеёрЋица;
	ќбъект.ѕрефиксЌомеровƒокументов = ѕрефиксЌомеровƒокументов;
	ќбъект.ѕолнЌаименование         = ѕолнЌаименование;
	ќбъект.»ЌЌ                      = »ЌЌ;
	ќбъект.“елефоны                 = “елефоны;
	ќбъект.ёрјдрес                  = ёрјдрес;
	ќбъект.‘актјдрес                = ‘актјдрес;
	
	// «аполнение реквизитов сло€ "ёрЋицоƒоп".
	ќбъект.‘орма—обственности       = ‘орма—обственности;
	ќбъект.ƒата–егистрации          = ƒата–егистрации;
	ќбъект.ќргѕрав‘орма             = ќргѕрав‘орма;
	ќбъект.ќфициальноеЌаименование  = ќфициальноеЌаименование;
	ќбъект.ќ ѕќ                     = ќ ѕќ;
	ќбъект.ќ ƒѕ                     = ќ ƒѕ;
	ќбъект.ќ ќЌ’                    = ќ ќЌ’;
	ќбъект.ќ ќѕ‘                    = ќ ќѕ‘;
	ќбъект.ќ ‘—                     = ќ ‘—;
	ќбъект.ќсновной¬идƒе€тельности  = ќсновной¬идƒе€тельности;
	
	// «аполнение реквизитов сло€ "ƒолжностныеЋица".
	ќбъект.ƒолжность–уководител€    = ƒолжность–уководител€;
	ќбъект.Ќаименование»ћЌ—         = Ќаименование»ћЌ—;
	ќбъект. од»ћЌ—                  =  од»ћЌ—;
	ќбъект.јдрес»ћЌ—                = јдрес»ћЌ—;
	
	// «аполнение реквизитов сло€ "”четна€ѕолитика".
	ќбъект.”читыватьЌƒ—             = ”читыватьЌƒ—;
	ќбъект.”читыватьЌѕ              = ”читыватьЌѕ;
	ќбъект.ћетод”чета–озницы = ѕеречисление.ћетоды”чета–озницы.«начениеѕоЌомеру(ћетоды”чета–озницы1);
	
	// ѕроверка возможности записи.
	// »меютс€ периодические реквизиты, 
	// поэтому элемент записываетс€ всегда.
	≈сли ћожно«аписатьЁлемент(ќбъект) = 0 “огда
		¬озврат 0;
	 онец≈сли;
	
	// ќбработке «аписьѕериодических–еквизитов необходимо передать
	// значени€ периодических реквизитов, введенные в форме диалога.
	—писок = —оздатьќбъект("—писок«начений");
	
	// «аполнение реквизитов сло€ "ƒолжностныеЋица".
	—писок.”становить("–уководитель", –уководитель);
	—писок.”становить("√лЅухгалтер",  √лЅухгалтер);
	—писок.”становить(" ассир",        ассир);
	
	// «аполнение реквизитов сло€ "”четна€ѕолитика".
	—писок.”становить("ћетодќпределени€¬ыручки"		, ѕеречисление.ћетодыќпределени€¬ыручки.«начениеѕоЌомеру(ћетодыќпределени€¬ыручки1));
	—писок.”становить("ћетод–асчета—ебестоимости"	, ѕеречисление.ћетоды–асчета—ебестоимости.«начениеѕоЌомеру(ћетоды–асчета—ебестоимости1));
	—писок.”становить("—тавкаЌѕсјванса"				, —тавкаЌѕсјванса);
	
	—писок.”становить("ЌомерЋиста ассовой ниги"		, ЌомерЋиста ассовой ниги);
	
	// ѕри записи вызываетс€ обработка «аписьѕериодических–еквизитов 
	// дл€ управлени€ записью значений периодических реквизитов.
	≈сли гл«аписьѕериодических–еквизитов(ќбъект, —писок, »спользоватьƒату(), '01.01.1980') = 0 “огда
		¬озврат 0;
	 онец≈сли;
	
	// ”становка юридического лица фирмы.
	ёрЋицо = ќбъект.“екущийЁлемент();
	
	¬озврат 1;
	
 онец‘ункции // «аписьёрЋица()

//******************************************************************************
// «аписьќсн—чета()
//
// ѕараметры:
//
// ¬озвращаемое значение:
//  1 - запись произведена.
//  0 - запись не произведена.
//
// ¬ызываетс€ из формул элементов диалога:
//
// ќписание:
//  ќсуществл€ет запись основного счета.
//
‘ункци€ «аписьќсн—чета()
	
	// —чет записываетс€, если указан номер.
	≈сли (ќсновной—чет.¬ыбран() = 0) » (ѕуста€—трока(Ќомер—чета) = 1) “огда
		¬озврат 1;
	 онец≈сли;
	
	// ќбъект дл€ записи основного счета.
	ќбъект = —оздатьќбъект("—правочник.Ѕанковские—чета");
	
	≈сли ќбъект.ЌайтиЁлемент(ќсновной—чет) = 0 “огда
		ќбъект.Ќовый();
	 онец≈сли;
		
	// «аполнение реквизитов сло€ "ќсновной—чет".
	ќбъект.Ќаименование      = Ќаименованиеќсн—чета;
	ќбъект.ёр‘изЋицо         = ёрЋицо;
	ќбъект.Ѕанк              = Ѕанк;
	ќбъект.Ѕанкƒл€–асчетов   = Ѕанкƒл€–асчетов;
	ќбъект.Ќомер—чета        = Ќомер—чета;
	ќбъект.¬алюта—чета       = ¬алюта—чета;
	ќбъект.ƒатаќткрыти€—чета = ƒатаќткрыти€—чета;
	ќбъект.ƒата«акрыти€—чета = ƒата«акрыти€—чета;
	ќбъект.—уммаЅез00 опеек  = —уммаЅез00 опеек;
	ќбъект.ћес€цѕрописью     = ћес€цѕрописью;
	ќбъект.–еквизитыѕлательщика»лиѕолучател€ = ¬ирт–еквизитыѕлательщика»лиѕолучател€;
	
	≈сли ¬алюта—чета = гл–убли “огда
		ќбъект.¬ид—чета             = ¬ид—четаЌомер–азрешени€;
		ќбъект.Ќомер»ƒата–азрешени€ = "";
	»наче
		ќбъект.¬ид—чета             = "";
		ќбъект.Ќомер»ƒата–азрешени€ = ¬ид—четаЌомер–азрешени€;
	 онец≈сли;
	
	// ѕроверка необходимости и возможности записи.
	≈сли      Ќужно«аписатьЁлемент(ќбъект) = 0 “огда
		¬озврат 1;
	»наче≈сли ћожно«аписатьЁлемент(ќбъект) = 0 “огда
		¬озврат 0;
	 онец≈сли;
	
	ќбъект.«аписать();
	
	// ”становка основного счета.
	ќсновной—чет = ќбъект.“екущийЁлемент();
	
	¬озврат 1;
	
 онец‘ункции // «аписьќсн—чета()

//******************************************************************************
// «апись”прјналитики()
//
// ѕараметры:
//
// ¬озвращаемое значение:
//  1 - запись произведена.
//  0 - запись не произведена.
//
// ¬ызываетс€ из формул элементов диалога:
//
// ќписание:
//  ќсуществл€ет запись упр. аналитики.
//
‘ункци€ «апись”прјналитики()
	
	// ќбъект дл€ записи упр. аналитики.
	ќбъект = —оздатьќбъект("—правочник.”прјналитика");
	≈сли ќбъект.ЌайтиЁлемент(”прјналитика) = 0 “огда
		ќбъект.Ќовый();
	 онец≈сли;
	
	// «аполнение реквизитов сло€ "”прјнлитика".
	ќбъект.Ќаименование = Ќаименование”прјналитики;
	
	// ѕроверка необходимости и возможности записи.
	≈сли      Ќужно«аписатьЁлемент(ќбъект) = 0 “огда
		¬озврат 1;
	»наче≈сли ћожно«аписатьЁлемент(ќбъект) = 0 “огда
		¬озврат 0;
	 онец≈сли;
	
	// «апись объекта.
	ќбъект.«аписать();
	
	// ”становка упр. аналитики.
	”прјналитика = ќбъект.“екущийЁлемент();
	
	¬озврат 1;
	
 онец‘ункции // «апись”прјналитики()

//******************************************************************************
// јвтозаполнение()
//
// ѕараметры:
//
// ¬озвращаемое значение:
//  Ќет.
//
// ¬ызываетс€ из формул элементов диалога:
//  ЌаименованиеёрЋица, ќргѕрав‘орма, Ќаименование”прјналитики.
//
// ќписание:
//  јвтозаполнение наименований.
//
ѕроцедура јвтозаполнение()
	
	≈сли ‘орма.јктивныйЁлемент() = "ЌаименованиеёрЋица" “огда
		≈сли ѕуста€—трока(ѕолнЌаименование) = 1 “огда
			ѕолнЌаименование = " """+—окрЋѕ(ЌаименованиеёрЋица)+"""";
		 онец≈сли;
		
	»наче≈сли ‘орма.јктивныйЁлемент() = "ќргѕрав‘орма" “огда
		≈сли ѕуста€—трока(ќфициальноеЌаименование) = 1 “огда
			ќфициальноеЌаименование = —окрЋѕ(ќргѕрав‘орма)+" """+—окрЋѕ(ЌаименованиеёрЋица)+"""";
		 онец≈сли;
	 онец≈сли;
	
 онецѕроцедуры // јвтозаполнение()

//******************************************************************************
// ѕри»зменении»ЌЌ()
//
// ѕараметры:
//
// ¬озвращаемое значение:
//  Ќет.
//
// ¬ызываетс€ из формул элементов диалога:
//  »ЌЌ.
//
// ќписание:
//  ѕровер€ет уникальность »ЌЌ в справочнике юр. лиц.
//
ѕроцедура ѕри»зменении»ЌЌ()
	
	// »ЌЌ может быть не указан.	
	ƒлина = ћетаданные.—правочник("—воиёрЋица").–еквизит("»ЌЌ").ƒлина;	
	≈сли —трƒлина(—окрЋѕ(»ЌЌ)) < ƒлина “огда
		¬озврат;
	 онец≈сли;
	
	// —писок найденных элементов с таким же »ЌЌ.
	—писок = —оздатьќбъект("—писок«начений");
	
	ќбъект = —оздатьќбъект("—правочник.—воиёрЋица");
	ќбъект.¬ыбратьЁлементыѕо–еквизиту("»ЌЌ", »ЌЌ, 0, 1);
	
	// ѕоиск элементов с таким же »ЌЌ.
	ѕока ќбъект.ѕолучитьЁлемент(1) = 1 ÷икл
		≈сли ќбъект.“екущийЁлемент() = ёрЋицо “огда
			¬озврат; // элемент уже был записан
		»наче
			—писок.ƒобавить«начение(ќбъект.“екущийЁлемент());
		 онец≈сли;
	 онец÷икла;
	
	// Ёлементы с таким же »ЌЌ не найдены.
	≈сли —писок.–азмер—писка() = 0 “огда
		¬озврат;
	
	// Ќайден один элемент с таким же »ЌЌ.
	»наче≈сли —писок.–азмер—писка() = 1 “огда
		—тр = "¬ справочнике """+ќбъект.ѕредставление¬ида()+""" уже есть элемент с таким же »ЌЌ!
		      |¬ыбрать существующий элемент справочника?";
		
		≈сли ¬опрос(—тр, "ƒа+Ќет", 60) = "ƒа" “огда
			ёрЋицо = —писок.ѕолучить«начение(1);
			ѕри»змененииёрЋица();
		 онец≈сли;
		
	// Ќайдено несколько элементов с таким же »ЌЌ.
	»наче
		—тр = "¬ справочнике """+ќбъект.ѕредставление¬ида()+""" уже есть элементы с таким же »ЌЌ!
		      |¬ыбрать один из существующих элементов справочника?";
		
		≈сли ¬опрос(—тр, "ƒа+Ќет", 60) = "ƒа" “огда
			≈сли —писок.¬ыбрать«начение(ёрЋицо, "Ёлементы с »ЌЌ "+»ЌЌ, 0, 60, 0) = 1 “огда
				ѕри»змененииёрЋица();
			 онец≈сли;
		 онец≈сли;
		
	 онец≈сли;
	
 онецѕроцедуры // ѕри»зменении»ЌЌ()

//******************************************************************************
// ѕри»змененииЌомера—чета()
//
// ѕараметры:
//
// ¬озвращаемое значение:
//  Ќет.
//
// ¬ызываетс€ из формул элементов диалога:
//  Ќомер—чета.
//
// ќписание:
//  ѕровер€ет уникальность номера банковского счета.
//
ѕроцедура ѕри»змененииЌомера—чета()
	
	—формировать–еквизит(ѕлательщикѕолучатель, "ѕлательщикѕолучатель");
	
	// Ќомер счета может быть не указан.	
	≈сли —трƒлина(—окрЋѕ(Ќомер—чета)) < 20 “огда
		¬озврат;
	 онец≈сли;
	
	// —писок найденных элементов с таким же номером счета.
	—писок = —оздатьќбъект("—писок«начений");
	
	ќбъект = —оздатьќбъект("—правочник.Ѕанковские—чета");
	ќбъект.¬ыбратьЁлементыѕо–еквизиту("ёр‘изЋицо", ёрЋицо, 0, 1);
	
	// ѕоиск элементов с таким же номером счета.
	ѕока ќбъект.ѕолучитьЁлемент(1) = 1 ÷икл
		≈сли ќбъект.“екущийЁлемент() = ќсновной—чет “огда
			¬озврат; // элемент уже был записан
		»наче≈сли ќбъект.Ќомер—чета = Ќомер—чета “огда
			—писок.ƒобавить«начение(ќбъект.“екущийЁлемент());
		 онец≈сли;
	 онец÷икла;
	
	// Ёлементы с таким же номером счета не найдены.
	≈сли —писок.–азмер—писка() = 0 “огда
		¬озврат;
	
	// Ќайден один элемент с таким же номером счета.
	»наче≈сли —писок.–азмер—писка() = 1 “огда
		—тр = "¬ справочнике """+ќбъект.ѕредставление¬ида()+
		      """ уже есть элемент с таким же номером счета!
		      |¬ыбрать существующий элемент справочника?";
		
		≈сли ¬опрос(—тр, "ƒа+Ќет", 60) = "ƒа" “огда
			ќсновной—чет = —писок.ѕолучить«начение(1);
			ѕри»змененииќсн—чета();
		 онец≈сли;
		
	// Ќайдено несколько элементов с таким же номером счета.
	»наче
		—тр = "¬ справочнике """+ќбъект.ѕредставление¬ида()+
		      """ уже есть элементы с таким же номером счета!
		      |¬ыбрать один из существующих элементов справочника?";
		
		≈сли ¬опрос(—тр, "ƒа+Ќет", 60) = "ƒа" “огда
			≈сли —писок.¬ыбрать«начение(ќсновной—чет, "Ёлементы с номером счета "+Ќомер—чета, 0, 60, 0) = 1 “огда
				ѕри»змененииќсн—чета();
			 онец≈сли;
		 онец≈сли;
		
	 онец≈сли;
	
 онецѕроцедуры // ѕри»змененииЌомера—чета()

//******************************************************************************
// ѕо нопкеЌаименование‘ирмы()
//
// ѕараметры:
//
// ¬озвращаемое значение:
//  Ќет.
//
// ¬ызываетс€ из формул элементов диалога:
//  кнЌаименование‘ирмы.
//
// ќписание:
//  ‘ормирует наименование фирмы.
//
ѕроцедура ѕо нопкеЌаименование‘ирмы()
	
	≈сли ѕуста€—трока(ЌаименованиеёрЋица) = 0 “огда
		Ќаименование = —окрЋѕ(ЌаименованиеёрЋица);
	»наче
		Ќаименование = "Ќе указано юр. лицо";
	 онец≈сли;
	
	≈сли ѕуста€—трока(Ќаименование”прјналитики) = 0 “огда
		Ќаименование = Ќаименование+" ("+—окрЋѕ(Ќаименование”прјналитики)+")";
	»наче
		Ќаименование = Ќаименование+" (не указана упр. аналитика)";
	 онец≈сли;
	
 онецѕроцедуры // ѕо нопкеЌаименование‘ирмы()

//******************************************************************************
// ѕо нопке«аполнитьќсновной—чет()
//
// ѕараметры:
//  Ќет.
//
// ¬озвращаемое значение:
//  Ќет.
//
// ¬ызываетс€ из формул элементов диалога:
//   нопка кн«аполнитьќсновной—чет.
//
// ќписание:
//
ѕроцедура ѕо нопке«аполнитьќсновной—чет()

	ѕараметры = —оздатьќбъект("—писок«начений");
	ѕараметры.ƒобавить«начение(—окрЋѕ(»ЌЌ),"»ЌЌ");
	ѕараметры.ƒобавить«начение(?(ѕуста€—трока(ѕолнЌаименование)=1,ЌаименованиеёрЋица,ѕолнЌаименование),"Ќаименование онтрагента");
	ѕараметры.ƒобавить«начение(—окрЋѕ(Ќомер—чета),"Ќомер—чета");
	ѕараметры.ƒобавить«начение(Ѕанк,"Ѕанк");
	ѕараметры.ƒобавить«начение(Ѕанкƒл€–асчетов,"Ѕанкƒл€–асчетов");
	// 1-заполнение плательщика или получател€, 2-заполнение назначени€ платежа
	ѕараметры.ƒобавить«начение(1,"–ежим");
	ќткрыть‘ормућодально("ќбработка.¬водѕлатежных–еквизитов", ѕараметры);
	¬ирт–еквизитыѕлательщика»лиѕолучател€ = ?(ѕараметры.ѕолучить("–езультат")="јвто","",ѕараметры.ѕолучить("–езультат"));
	
	—формировать–еквизит(ѕлательщикѕолучатель, "ѕлательщикѕолучатель");

 онецѕроцедуры // ѕо нопке«аполнитьќсновной—чет()

//******************************************************************************
// ѕо нопкеќчистить()
//
// ѕараметры:
//
// ¬озвращаемое значение:
//  Ќет.
//
// ¬ызываетс€ из формул элементов диалога:
//  кнќчиститьёрЋицо, кнќчиститьќсн—чет, кнќчистить”прјналитику.
//
// ќписание:
//  ќчищает реквизиты фирмы.
//
ѕроцедура ѕо нопкеќчистить()
	
	≈сли ‘орма.јктивныйЁлемент() = "кнќчиститьёрЋицо" “огда
		ёрЋицо = ѕолучитьѕустое«начение("—правочник.—воиёрЋица");
		ѕри»змененииёрЋица();
		
		јктивизировать("ЌаименованиеёрЋица");
		
	»наче≈сли ‘орма.јктивныйЁлемент() = "кнќчиститьќсн—чет" “огда
		ќсновной—чет = ѕолучитьѕустое«начение("—правочник.Ѕанковские—чета");
		ѕри»змененииќсн—чета();
		
		јктивизировать("Ќаименованиеќсн—чета"); 
		
	»наче≈сли ‘орма.јктивныйЁлемент() = "кнќчистить”прјналитику" “огда
		”прјналитика = ѕолучитьѕустое«начение("—правочник.”прјналитика");
		ѕри»зменении”прјналитики();
		
		јктивизировать("Ќаименование”прјналитики"); 
	 онец≈сли;
	
 онецѕроцедуры // ѕо нопкеќчистить()

//******************************************************************************
// ѕо нопке¬водајдреса(јдрес1, јдрес2+"")
//
// ѕараметры:
//  јдрес1 - реквизит, в который будет введен адрес.
//  јдрес2 - реквизит, в который будет скопирован адрес.
//
// ¬озвращаемое значение:
//  Ќет.
//
// ¬ызываетс€ из формул элементов диалога:
//   нопки ввода адреса.
//
// ќписание:
//  ¬ызывает обработку дл€ ввода адреса.
//
ѕроцедура ѕо нопке¬водајдреса(јдрес1, јдрес2="")

	гл¬водјдреса(јдрес1);
	
	≈сли ѕуста€—трока(глѕредставлениејдреса(јдрес2)) = 1 “огда
		јдрес2 = јдрес1;
	 онец≈сли;
	
 онецѕроцедуры // ѕо нопке¬водајдреса()

//******************************************************************************
// ѕо нопкеќткрыть(ќбъект)
//
// ѕараметры:
//  ќбъект - объект, который необходимо открыть.
//
// ¬озвращаемое значение:
//  Ќет.
//
// ¬ызываетс€ из формул элементов диалога:
//   нопки "ќткрыть".
//
// ќписание:
//  ќткрывает форму объекта.
//
ѕроцедура ѕо нопкеќткрыть(ќбъект, Ёлементƒиалога="")
	
	≈сли ќбъект.¬ыбран() = 1 “огда
		ќткрыть‘ормућодально(ќбъект, , -1);
	»наче
		јктивизировать(Ёлементƒиалога, 1);
	 онец≈сли;
	
 онецѕроцедуры // ѕо нопкеќткрыть()

//******************************************************************************
// ѕо нопке¬ыбораƒаты()
//
// ѕараметры:
//
// ¬озвращаемое значение:
//  Ќет.
//
// ¬ызываетс€ из формул элементов диалога:
//   нопка выбора даты.
//
// ќписание:
//  ¬ыбираетс€ дата просмотра и редактировани€ значений периодических реквизитов 
// выбираетс€ по кнопке, чтобы не мен€лс€ признак модифицированности формы.
//
ѕроцедура ѕо нопке¬ыбораƒаты()
	
	≈сли гл¬вестиƒатуѕериодических–еквизитов( онтекст, 0) = 1 “огда
		ѕри»зменении“екущейƒаты();
	 онец≈сли;
	
 онецѕроцедуры // ѕо нопке¬ыбораƒаты()

//******************************************************************************
// ѕо нопке»стори€()
//
// ѕараметры:
//
// ¬озвращаемое значение:
//  Ќет.
//
// ¬ызываетс€ из формул элементов диалога:
//   нопка "»стори€".
//
// ќписание:
//  ¬ызываетс€ обработка "«начени€ѕериодических–еквизитов" дл€ просмотра истории 
// значений периодических реквизитов.
//
ѕроцедура ѕо нопке»стори€()
	
	≈сли      ‘орма.«акладки.“екуща€—трока() = 3 “огда // слой "ƒолжностныеЋица"
		¬идимые–еквизиты = "–уководитель, √лЅухгалтер,  ассир";
		
	»наче≈сли ‘орма.«акладки.“екуща€—трока() = 4 “огда // слой "”четна€ѕолитика"
		¬идимые–еквизиты = "ћетодќпределени€¬ыручки, ћетод–асчета—ебестоимости, —тавкаЌѕсјванса";

	»наче
		¬идимые–еквизиты = "";
	 онец≈сли;
	
	≈сли ѕустое«начение(ёрЋицо.“екущийЁлемент()) = 0 “огда
		гл«начени€ѕериодических–еквизитов(ёрЋицо, , , ¬идимые–еквизиты);
	»наче
		—трокаƒействий‘ормы = "# «аписать?";
	 онец≈сли;
	
 онецѕроцедуры // ѕо нопке»стори€()

//******************************************************************************
// ѕо нопкеќткрыть—правочник(—правочник, «нач ѕараметр, «нач ќбъект=0)
//
// ѕараметры:
//  —правочник - "строка" - вид справочника.
//  ѕераметр   - параметр дл€ передачи в форму.
//  ќбъект     - объект, который следует активизировать в форме.
//
// ¬озвращаемое значение:
//  ¬ немодальном режиме - контекст открытой формы.
//
// ¬ызываетс€ из формул элементов диалога:
//   нопки открыти€ подчиненных справочников.
//
// ќписание:
//  ќткрывает форму списка указанного справочника.
//
‘ункци€ ѕо нопкеќткрыть—правочник(—правочник, «нач ѕараметр, «нач ќбъект=0)
	
	≈сли ѕустое«начение(ѕараметр) = 1 “огда
		ѕредупреждение("Ёлемент еще не записан. —правочник не может быть открыт!", 60);
		¬озврат ѕолучитьѕустое«начение();
		
	»наче
		ќткрыть‘орму("—правочник."+—правочник, ѕараметр);
	 онец≈сли;
		
	≈сли (“ип«начени€—тр(ѕараметр) = "√рупповой онтекст") » (ѕустое«начение(ќбъект) = 0) “огда
		ѕараметр.јктивизироватьќбъект(ќбъект);
	 онец≈сли;
	
	¬озврат ѕараметр;
	
 онец‘ункции // ѕо нопкеќткрыть—правочник()

//******************************************************************************
// ”становить«аголовкиѕеречислени€(»дентификатор)
//
// ѕараметры:
//  »дентификатор - "ћетодыќпределени€¬ыручки" 
//                  "ћетоды–асчета—ебестоимости"
//
// ¬озвращаемое значение:
//  Ќет.
//
// ¬ызываетс€ из формул элементов диалога:
//
// ќписание:
//  ”станавливает заголовки элементов диалога.
//
ѕроцедура ”становить«аголовкиѕеречислени€(»дентификатор)
	
	ƒл€ Ќомер = 1 ѕо ћетаданные.ѕеречисление(»дентификатор).«начение() ÷икл
		мд«начение  = ћетаданные.ѕеречисление(»дентификатор).«начение(Ќомер);
		«аголовок   = ?(ѕуста€—трока(мд«начение. омментарий) = 0, " ("+Ќрег(мд«начение. омментарий)+")", "");
		
		‘орма.ѕолучитьјтрибут(»дентификатор+Ќомер).«аголовок(мд«начение.ѕредставление+«аголовок); 
	 онец÷икла;
	
 онецѕроцедуры // ”становить«аголовкиѕеречислени€()

////////////////////////////////////////////////////////////////////////////////
// ѕ–≈ƒќѕ–≈ƒ≈Ћ≈ЌЌџ≈ ѕ–ќ÷≈ƒ”–џ
// 
//******************************************************************************
// ѕредопределенна€ процедура.
//
ѕроцедура ¬водЌового(‘лаг опировани€)
	
	ћетодыќпределени€¬ыручки1   = ѕеречисление.ћетодыќпределени€¬ыручки.ѕоќтгрузке.ѕор€дковыйЌомер();
	ћетоды–асчета—ебестоимости1 = ѕеречисление.ћетоды–асчета—ебестоимости.FIFO.ѕор€дковыйЌомер();
	ћетоды”чета–озницы1 		= ѕеречисление.ћетоды”чета–озницы.ѕоѕродажным÷енам.ѕор€дковыйЌомер();
	
	”читыватьЌƒ—                = 1;
	”читыватьЌѕ                 = 0;
	
	¬алюта—чета = гл–убли;
	
 онецѕроцедуры // ¬водЌового()

//******************************************************************************
// ѕредопределенна€ процедура.
//
ѕроцедура ѕриќткрытии()
	
	≈сли ‘орма.“олькоѕросмотр() = 1 “огда
		‘орма.кнЌаименование‘ирмы.ƒоступность(0);
		‘орма.кнќчиститьёрЋицо.ƒоступность(0);
		‘орма.кн¬водаёрјдреса.ƒоступность(0);
		‘орма.кн¬вода‘актјдреса.ƒоступность(0);
		‘орма.кн¬водајдреса»ћЌ—.ƒоступность(0);
		
		‘орма.кнќчиститьќсн—чет.ƒоступность(0);
		‘орма.кнќчиститьЅанкƒл€–асчетов.ƒоступность(0);
		
		‘орма.кнќчистить”прјналитику.ƒоступность(0);
		
		‘орма.кн«аписать.ƒоступность(0);
		‘орма.кнќ .ƒоступность(0);
		
		‘орма. нопкаѕо”молчанию("кн«акрыть");
	»наче
	    ‘орма. нопкаѕо”молчанию("кнќк");
	 онец≈сли;
	
	// «аполнение реквизитов диалога.
	// ≈сли реквизиты справочника не заполнены - в диалоге 
	// сохран€тс€ значени€, присвоенные в процедуре ¬водЌового().
	
	≈сли ёрЋицо.¬ыбран() = 1 “огда
		ѕри»змененииёрЋица();
	 онец≈сли;
	
	≈сли ”прјналитика.¬ыбран() = 1 “огда
		ѕри»зменении”прјналитики();
	 онец≈сли;
	
	≈сли ќсновной—чет.¬ыбран() = 1 “огда
		ѕри»змененииќсн—чета();
	 онец≈сли;
	
	«акладка = 0;
	≈сли ѕустое«начение(‘орма.ѕараметр) = 0  “огда // могли передать нужную закладку
		«акладка = ‘орма.«акладки.ѕолучить(‘орма.ѕараметр);
	 онец≈сли; 
	«акладка = ћакс(1, ‘орма.«акладки.Ќайти«начение(«акладка));
	‘орма.«акладки.“екуща€—трока(«акладка);
	‘орма.»спользовать—лой(‘орма.«акладки.ѕолучить«начение(«акладка), 2);
	
 онецѕроцедуры // ѕриќткрытии()

//******************************************************************************
// ѕредопределенна€ процедура.
//
ѕроцедура ѕри¬ыборе«акладки(Ќомер«акладки, «начение«акладки)
	
	‘орма.»спользовать—лой(«начение«акладки, 2);
	≈сли Ќайти(«начение«акладки,"ќсновной—чет")<>0 “огда
		—формировать–еквизит(ѕлательщикѕолучатель, "ѕлательщикѕолучатель");
	 онец≈сли;
	
 онецѕроцедуры // ѕри¬ыборе«акладки()

//******************************************************************************
// ѕредопределенна€ процедура.
//
ѕроцедура ѕриЌачале¬ыбора«начени€(Ёлементƒиалога)
	
	≈сли Ёлементƒиалога = "ЌаименованиеёрЋица" “огда
		ѕараметр = ѕо нопкеќткрыть—правочник("—воиёрЋица", 1, ёрЋицо);
		≈сли “ип«начени€—тр(ѕараметр) = "—правочник" “огда // модальный режим
			ёрЋицо = ѕараметр;
			ѕри»змененииёрЋица();
		 онец≈сли;
		
	»наче≈сли Ёлементƒиалога = "Ќаименованиеќсн—чета" “огда
		ѕараметр = ѕо нопкеќткрыть—правочник("Ѕанковские—чета", ёрЋицо, ќсновной—чет);
		≈сли “ип«начени€—тр(ѕараметр) = "—правочник" “огда
			ќсновной—чет = ѕараметр;
			ѕри»змененииќсн—чета();
		 онец≈сли;
			
	»наче≈сли Ёлементƒиалога = "¬алюта—чета" “огда
		≈сли ќсновной—чет.¬ыбран() = 1 “огда
			ѕредупреждение("Ќельз€ измен€ть валюту банковского счета.
			               |¬ведите новый счет или скопируйте существующий!", 60);
			—татус¬озврата(0);
		 онец≈сли;
		
	»наче≈сли Ёлементƒиалога = "Ќаименование”прјналитики" “огда
		ѕараметр = ѕо нопкеќткрыть—правочник("”прјналитика", 1, ”прјналитика);
		≈сли “ип«начени€—тр(ѕараметр) = "—правочник" “огда // модальный режим
			”прјналитика = ѕараметр;
			ѕри»зменении”прјналитики();
		 онец≈сли;
		
	 онец≈сли;
	
 онецѕроцедуры // ѕриЌачале¬ыбора«начени€()

//******************************************************************************
// ѕредопределенна€ процедура.
//
ѕроцедура ќбработка¬ыбора«начени€(Ќовое«начение, Ёлементƒиалога)
	
	≈сли Ёлементƒиалога = "ЌаименованиеёрЋица" “огда
		ёрЋицо = Ќовое«начение;
		ѕри»змененииёрЋица();
		
	»наче≈сли Ёлементƒиалога = "Ќаименованиеќсн—чета" “огда
		ќсновной—чет = Ќовое«начение;
		ѕри»змененииќсн—чета();
		
	»наче≈сли Ёлементƒиалога = "Ќаименование”прјналитики" “огда
		”прјналитика = Ќовое«начение;
		ѕри»зменении”прјналитики();
		
	 онец≈сли;
	
 онецѕроцедуры // ќбработка¬ыбора«начени€()

//******************************************************************************
// ѕредопределенна€ процедура.
//
ѕроцедура ѕри«аписи()
	
	// ќбновление текстовых полей
	—формировать–еквизит(ѕлательщикѕолучатель, "ѕлательщикѕолучатель");

	// ѕроверка заполненности об€зательных реквизитов.
	
	// Ќаименование фирмы.
	≈сли ѕуста€—трока(Ќаименование) = 1 “огда
		ѕредупреждение("Ќе указано наименование фирмы!", 60);
		јктивизировать("Ќаименование");
		—татус¬озврата(0); ¬озврат;
	 онец≈сли;
		
	// Ќаименование юр. лица.
	≈сли ѕуста€—трока(ЌаименованиеёрЋица) = 1 “огда
		ѕредупреждение("Ќе указано наименование юридического лица фирмы!", 60);
		‘орма.«акладки.“екуща€—трока(1);
		‘орма.»спользовать—лой(‘орма.«акладки.ѕолучить«начение(1));
		јктивизировать("ЌаименованиеёрЋица");
		—татус¬озврата(0); ¬озврат;
	 онец≈сли;
	
	// ћетод определени€ выручки юр. лица.
	≈сли ћетодыќпределени€¬ыручки1 = 0 “огда
		ѕредупреждение("Ќе выбран метод определени€ выручки юридического лица!", 60);
		‘орма.«акладки.“екуща€—трока(4);
		‘орма.»спользовать—лой(‘орма.«акладки.ѕолучить«начение(4));
		јктивизировать("ћетодыќпределени€¬ыручки1");
		—татус¬озврата(0); ¬озврат;
	 онец≈сли;
	
	// ћетод расчета себестоимости юр. лица.
	≈сли ћетоды–асчета—ебестоимости1 = 0 “огда
		ѕредупреждение("Ќе выбран метод расчета себестоимости юридического лица!", 60);
		‘орма.«акладки.“екуща€—трока(4);
		‘орма.»спользовать—лой(‘орма.«акладки.ѕолучить«начение(4));
		јктивизировать("ћетоды–асчета—ебестоимости1");
		—татус¬озврата(0); ¬озврат;
	 онец≈сли;     
	
	// ћетод учета розницы юр. лица.
	≈сли ћетоды–асчета—ебестоимости1 = 0 “огда
		ѕредупреждение("Ќе выбран метод учета розницы юридического лица!", 60);
		‘орма.«акладки.“екуща€—трока(4);
		‘орма.»спользовать—лой(‘орма.«акладки.ѕолучить«начение(4));
		јктивизировать("ћетоды”чета–озницы1");
		—татус¬озврата(0); ¬озврат;
	 онец≈сли;
	
	// Ќаименование упр. аналитики.
	≈сли ѕуста€—трока(Ќаименование”прјналитики) = 1 “огда
		ѕредупреждение("Ќе указано наименование объекта упр. аналитики!", 60);
		‘орма.«акладки.“екуща€—трока(5);
		‘орма.»спользовать—лой(‘орма.«акладки.ѕолучить«начение(5));
		јктивизировать("Ќаименование”прјналитики");
		—татус¬озврата(0); ¬озврат;
	 онец≈сли;
	
	≈сли (ќсновной—чет.¬ыбран() = 1) »Ћ» 
	     (ѕуста€—трока(Ќомер—чета) = 0) »Ћ» 
		 (ѕуста€—трока(Ќаименованиеќсн—чета) = 0) “огда
		 	
		// Ќаименование основного банковского счета.
		≈сли ѕуста€—трока(Ќаименованиеќсн—чета) = 1 “огда
			ѕредупреждение("Ќе указано наименование основного банковского счета!", 60);
			‘орма.«акладки.“екуща€—трока(6);
			‘орма.»спользовать—лой(‘орма.«акладки.ѕолучить«начение(6));
			јктивизировать("Ќаименованиеќсн—чета");
			—татус¬озврата(0); ¬озврат;
		 онец≈сли;

		// ¬алюта основного банковского счета.
		≈сли ¬алюта—чета.¬ыбран() = 0 “огда
			ѕредупреждение("Ќе выбрана валюта основного банковского счета!", 60);
			‘орма.«акладки.“екуща€—трока(6);
			‘орма.»спользовать—лой(‘орма.«акладки.ѕолучить«начение(6));
			јктивизировать("¬алюта—чета");
			—татус¬озврата(0); ¬озврат;
		 онец≈сли;

		// Ѕанк основного банковского счета.
		≈сли Ѕанк.¬ыбран() = 0 “огда
			ѕредупреждение("Ќе выбран банк основного банковского счета!", 60);
			‘орма.«акладки.“екуща€—трока(6);
			‘орма.»спользовать—лой(‘орма.«акладки.ѕолучить«начение(6));
			јктивизировать("Ѕанк");
			—татус¬озврата(0); ¬озврат;
		 онец≈сли;

		// Ќомер банковского счета.
		≈сли глѕроверкаЌомера—чета(Ќомер—чета, Ѕанк. од, Ѕанк. орр—чет) = 0 “огда
			≈сли ¬опрос("¬озможно, номер основного счета указан неверно. ѕродолжить?", "ƒа+Ќет", 60) <> "ƒа" “огда
				‘орма.«акладки.“екуща€—трока(6);
				‘орма.»спользовать—лой(‘орма.«акладки.ѕолучить«начение(6));
				јктивизировать("Ќомер—чета");
				—татус¬озврата(0); ¬озврат;
			 онец≈сли;
		 онец≈сли;     
		
	 онец≈сли;
		
	// «апись всех изменений производитс€ в одной транзакции.
	
	ѕопытка
		Ќачать“ранзакцию();
		—татус¬озврата(0);
		
		«аписать();
		≈сли «аписьёрЋица() = 1 “огда
			≈сли «аписьќсн—чета() = 1 “огда
				≈сли «апись”прјналитики() = 1 “огда
					
					«афиксировать“ранзакцию();
					—татус¬озврата(1);
					
				 онец≈сли;
			 онец≈сли;
		 онец≈сли;

	»сключение
		—ообщить(ќписаниеќшибки(), "!");
	 онецѕопытки;
	
 онецѕроцедуры // ѕри«аписи()

////////////////////////////////////////////////////////////////////////////////
// ќѕ≈–ј“ќ–џ ќ—Ќќ¬Ќќ… ѕ–ќ√–јћћџ
// 
// Ќомер закладки используетс€ в процедурах и функци€х модул€!
‘орма.»спользовать«акладки(1);
‘орма.«акладки.ƒобавить«начение("‘ирма,  нопки, ёрЋицо",          "ќсновные");
‘орма.«акладки.ƒобавить«начение("‘ирма,  нопки, ёрЋицоƒоп",       "ƒополнительные");
‘орма.«акладки.ƒобавить«начение("‘ирма,  нопки, ƒолжностныеЋица", "ƒолжн. лица, ћЌ—");
‘орма.«акладки.ƒобавить«начение("‘ирма,  нопки, ”четна€ѕолитика", "”четна€ политика");
‘орма.«акладки.ƒобавить«начение("‘ирма,  нопки, ”прјналитика",    "”пр. аналитика");
‘орма.«акладки.ƒобавить«начение("‘ирма,  нопки, ќсновной—чет",    "Ѕанковский счет");
‘орма.«акладки.ƒобавить«начение("‘ирма,  нопки, ѕрочее",          "ѕрочее");

”становить«аголовкиѕеречислени€("ћетодыќпределени€¬ыручки");
”становить«аголовкиѕеречислени€("ћетоды–асчета—ебестоимости");
”становить«аголовкиѕеречислени€("ћетоды”чета–озницы");
