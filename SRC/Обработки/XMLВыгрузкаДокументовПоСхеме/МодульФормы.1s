////////////////////////////////////////////////////////////////////////////////
// ѕ≈–≈ћ≈ЌЌџ≈ ћќƒ”Ћя
// 
ѕерем	ƒок;					//	выгружаемый документ
ѕерем	—писокјтрибутов;		//	вспомогательный список
								//	ѕри выгрузке документа список заполн€етс€ значени€ми реквизитов, которые затем 
								//	извлекаютс€, при добавлении XML-элементов

ѕерем	 аталог»дентификации;	//	каталог (элемент справочника " аталоги") по которому идентифицируютс€ товары
ѕерем	—пособ»дентификации;	//	если каталог собственный, то по какому реквизиту идентифицируютс€ товары (код, артикул, штрихкод)
ѕерем	¬месте— аталогом;		//	если 1, то нужно добавить XML-элемент " аталог" с описанием товарных позиций документа
ѕерем	Ёл аталог;				//	XML-элемент " аталог", если ¬месте— аталогом = 1

ѕерем	‘лагќшибки;				//	если 1, значит где-то произошел сбой...
  

////////////////////////////////////////////////////////////////////////////////
// ѕ–ќ÷≈ƒ”–џ » ‘”Ќ ÷»» ћќƒ”Ћя
// 
//******************************************************************************
// —оздатьѕодчиненныйЁлемент(Ёл¬ладелец, »м€“ега, «начение, ‘л≈слиѕустоеЌеƒобавл€ть)
//
// ѕараметры:
//	Ёл¬ладелец				-	элемент родитель
//	»м€“ега					-	тег подчиненного элемента
//	«начение				-	значение подчиненного элемента
//	‘л≈слиѕустоеЌеƒобавл€ть	-	флаг, если переданное значение пустое, то элемент добавл€ть не следует
//
// ¬озвращаемое значение:
//	XML-элемент
//
// ќписание
//	—оздает и возвращает элемент, подчиненный  элементу-владельцу, если передано значение, то устанавливаетс€
//
‘ункци€ —оздатьѕодчиненныйЁлемент(Ёл¬ладелец, »м€“ега, «начение="", ‘л≈слиѕустоеЌеƒобавл€ть=0)
	
	≈сли (‘л≈слиѕустоеЌеƒобавл€ть = 1) » (ѕустое«начение(«начение) = 1) “огда ¬озврат ""  онец≈сли;
	
	Ёл¬озврата = Ёл¬ладелец.—оздатьѕодчиненныйЁлемент(»м€“ега, , "urn:CommerceML");
	≈сли «начение <> "" “огда
	    Ёл¬озврата.«начение = —окрЋѕ(«начение);
	 онец≈сли;
	
	¬озврат Ёл¬озврата;
	
 онец‘ункции		//	—оздатьѕодчиненныйЁлемент()

//******************************************************************************
// ѕроверить»”становитьјтрибут(Ёл, »дјтрибута, «нјтрибута)
//
// ѕараметры:
// 	Ёл			-	Ёлемент, атрибут которого устанавливаем
//	»дјтрибута	-	»дентификатор атрибута
//	«нјтрибута	-	устанавливаемое значение
//
// ¬озвращаемое значение:
// 	нет
//
// ќписание
//	”станавливает значение атрибута элемента, если оно не пустое
//
ѕроцедура ѕроверить»”становитьјтрибут(Ёл, »дјтрибута, «нјтрибута);
	
	≈сли ѕустое«начение(«нјтрибута) = 0 “огда
		≈сли “ип«начени€—тр(«нјтрибута) <> "ƒата" “огда
			Ёл.”становитьјтрибут(»дјтрибута, —окрЋѕ(«нјтрибута));
		»наче
        	Ёл.”становитьјтрибут(»дјтрибута, «нјтрибута);
		 онец≈сли;
		
	 онец≈сли;    
	
 онецѕроцедуры		//	ѕроверить»”становитьјтрибут()

//******************************************************************************
// »д(Ёл, «н)
//		
// ѕараметры:
//	Ёл	-	любой XML-элемент
//	«н	-	значение, которое преобразуетс€ в id
//		
// ¬озвращаемое значение:
//	√енерирует корректный идентификатор типа - id
//		
‘ункци€ »д(Ёл, «н)
	
	≈сли ѕустое«начение(«н) = 0 “огда
		¬озврат Ёл.ѕреобразовать¬_»ƒ(«начение¬—троку¬нутр(«н));
	»наче
		¬озврат("");
	 онец≈сли;
	
 онец‘ункции		//	»д()

//******************************************************************************
// ”становитьјтрибуты аталога()
//
// ѕараметры:
//	Ёл	-	XML-элемент 
//
// ¬озвращаемое значение:
// 	”станавливает атрибуты каталога
//
// ќписание
// 	”станавливает атрибуты каталога в соответствии со схемой CommerceML
//
ѕроцедура ”становитьјтрибуты аталога(Ёл)
	                                                    
	ѕроверить»”становитьјтрибут(Ёл, "»дентификатор",	 аталог»дентификации.»дентификатор);
	ѕроверить»”становитьјтрибут(Ёл, "Ќаименование",		 аталог»дентификации.Ќаименование);
	ѕроверить»”становитьјтрибут(Ёл, "¬ладелец",			 аталог»дентификации.¬ладелец аталога.»дентификатор);
	ѕроверить»”становитьјтрибут(Ёл, "ќписание", 		 аталог»дентификации. омментарий);
	ѕроверить»”становитьјтрибут(Ёл, "≈диница", 			 аталог»дентификации.≈диницаѕо”молчанию.Ќаименование);
	
 онецѕроцедуры		//	”становитьјтрибуты аталога()

//******************************************************************************
// ”становитьјтрибуты онтрагента_ѕо онтрагенту(Ёл онтрагент,  онтрагент)
//		
// ѕараметры:
//	Ёл онтрагент	-	XML-элемент " онтрагент"
//	 онтрагент		-	элемент справочника " онтрагенты"
//		
// ¬озвращаемое значение:
// 	Ќет.
//		
// ќписание
//	”станавливает атрибуты элемента " онтрагент" в соответствии со схемой
//		
ѕроцедура ”становитьјтрибуты онтрагента(Ёл онтрагент,  онтрагент)
	
	≈сли  онтрагент.¬ид() = "‘ирмы" “огда
		ёр‘изЋицо				=	 онтрагент.ёрЋицо;
	»наче
		ёр‘изЋицо				=	 онтрагент.ёр‘изЋицо;
	 онец≈сли;
	
    »дентификатор				=	—окрЋѕ( онтрагент.»дентификатор);
	ќтображаемоеЌаименование	=	—окрЋѕ( онтрагент.Ќаименование);
	Ќаименование				=	?(ѕустое«начение(ёр‘изЋицо.ѕолнЌаименование)=1, ќтображаемоеЌаименование, —окрЋѕ(ёр‘изЋицо.ѕолнЌаименование));
	јдрес						=	—окрЋѕ(ёр‘изЋицо.‘актјдрес);
	ёридическийјдрес			=	—окрЋѕ(ёр‘изЋицо.ёрјдрес);
	//—айт						=	—окрЋѕ( онтрагент.—айт.јдрес—айта);
	// омментарий				=	—окрЋѕ( онтрагент. омментарий);
	//ќсновной онтакт			=	"";

    ѕроверить»”становитьјтрибут(Ёл онтрагент, "»дентификатор", 				»дентификатор);
	ѕроверить»”становитьјтрибут(Ёл онтрагент, "Ќаименование",				Ќаименование);
	ѕроверить»”становитьјтрибут(Ёл онтрагент, "ќтображаемоеЌаименование",	ќтображаемоеЌаименование);
	ѕроверить»”становитьјтрибут(Ёл онтрагент, "јдрес",						јдрес);
	ѕроверить»”становитьјтрибут(Ёл онтрагент, "ёридическийјдрес",			ёридическийјдрес);
	//ѕроверить»”становитьјтрибут(Ёл онтрагент, "—айт",						—айт);
	//ѕроверить»”становитьјтрибут(Ёл онтрагент, " омментарий",				 омментарий);
	//ѕроверить»”становитьјтрибут(Ёл онтрагент, "ќсновной онтакт",			ќсновной онтакт);
	
 онецѕроцедуры		//	”становитьјтрибуты онтрагента()
    
//******************************************************************************
// ƒобавитьЁлемент_ƒополнительный–еквизит()
//		
// ѕараметры:
//	Ёл–одитель		-	XML-элемент
//	»м€–еквизита	-	»дентификатор дополнительного реквизита
//	«н–еквизита		-	значение дополнительного реквизита
//		
// ¬озвращаемое значение:
// 	Ќет.
//		
// ќписание
//	”станавливает атрибуты элемента "ƒополнительный–еквизит" в соответствии со схемой
//		                                                                                                    
ѕроцедура ƒобавитьЁлемент_ƒополнительный–еквизит(Ёл–одитель, »м€–еквизита, «н–еквизита)
	                                                    
	Ёл–еквизит = —оздатьѕодчиненныйЁлемент(Ёл–одитель, "ƒополнительный–еквизит");
	
	ѕроверить»”становитьјтрибут(Ёл–еквизит, "Ќаименование",	»м€–еквизита);
	ѕроверить»”становитьјтрибут(Ёл–еквизит, "«начение",		«н–еквизита);
              
 онецѕроцедуры		//	ƒобавитьЁлемент_ƒополнительный–еквизит()

//******************************************************************************
// ƒобавитьЁлемент_ онтакт()
//		
// ѕараметры:
//	Ёл–одитель	-	XML-Ёлемент
//	 онтрагент	-	контактный контрагент
//		
// ¬озвращаемое значение:
// 	XML-элемент " онтакт"
//		
// ќписание
//	ƒобавл€ет XML-элемент " онтакт" и устанавливает его атрибуты в соответствии со схемой
//		
‘ункци€ ƒобавитьЁлемент_ онтакт(Ёл–одитель,  онтрагент)
	
	≈сли ѕустое«начение( онтрагент) = 1 “огда ¬озврат ѕолучитьѕустое«начение()  онец≈сли;
	
	Ёл онтакт = —оздатьѕодчиненныйЁлемент(Ёл–одитель, " онтакт");
	
	≈сли  онтрагент.¬ид() = "‘ирмы" “огда
		ёр‘изЋицо	=	 онтрагент.ёрЋицо;
	»наче
		ёр‘изЋицо	=	 онтрагент.ёр‘изЋицо;
	 онец≈сли;
	
	ѕроверить»”становитьјтрибут(Ёл онтакт, "»дентификатор",	»д(Ёл онтакт,  онтрагент));
	ѕроверить»”становитьјтрибут(Ёл онтакт, "Ќаименование",	 онтрагент.Ќаименование);
	ѕроверить»”становитьјтрибут(Ёл онтакт, " омментарий",	"");
	
	—оздатьѕодчиненныйЁлемент(Ёл онтакт, " онтактноеЋицо",	—писокјтрибутов.ѕолучить(" онтактноеЋицо"),	1);
	—оздатьѕодчиненныйЁлемент(Ёл онтакт, "“елефон", 		ёр‘изЋицо.“елефоны,							1);
	—оздатьѕодчиненныйЁлемент(Ёл онтакт, "ѕочта", 			 онтрагент.Ёлѕочта,							1);
	//—оздатьѕодчиненныйЁлемент(Ёл онтакт, "‘акс", 			"",											1);
	//—оздатьѕодчиненныйЁлемент(Ёл онтакт, "ICQ", 			"",											1);
	         
	¬озврат Ёл онтакт;
	
 онец‘ункции		//	ƒобавитьЁлемент_ онтакт()
                        
//******************************************************************************
// ƒобавитьЁлемент_Ѕанк(Ёл–одитель, Ѕанк)
//		
// ѕараметры:
//	Ёл–одитель	-	XML-Ёлемент
//	Ѕанк		-	элемент справочника "Ѕанки"
//		
// ¬озвращаемое значение:
// 	XML-элемент "Ѕанк"
//		
// ќписание
//	ƒобавл€ет XML-элемент "Ѕанк" и устанавливает его атрибуты в соответствии со схемой
//		
‘ункци€ ƒобавитьЁлемент_Ѕанк(Ёл–одитель, Ѕанк)
    
	≈сли ѕустое«начение(Ѕанк) = 1 “огда ¬озврат ѕолучитьѕустое«начение()  онец≈сли;
	
	ЁлЅанк = —оздатьѕодчиненныйЁлемент(Ёл–одитель, "Ѕанк");
	
	ѕроверить»”становитьјтрибут(ЁлЅанк, "»дентификатор",	»д(ЁлЅанк, Ѕанк));
	ѕроверить»”становитьјтрибут(ЁлЅанк, "Ќаименование",		Ѕанк.Ќаименование);
	ѕроверить»”становитьјтрибут(ЁлЅанк, "ћестонахождение",	Ѕанк.ћестонахождение);
	ѕроверить»”становитьјтрибут(ЁлЅанк, "Ѕ» ",				Ѕанк. од);
	ѕроверить»”становитьјтрибут(ЁлЅанк, "Ќомер—чета",		Ѕанк. орр—чет);
	ѕроверить»”становитьјтрибут(ЁлЅанк, "јдрес",			Ѕанк.јдрес);
	ѕроверить»”становитьјтрибут(ЁлЅанк, "“елефон",			Ѕанк.“елефоны);
	//ѕроверить»”становитьјтрибут(ЁлЅанк, " омментарий",		"");	
         
	¬озврат ЁлЅанк;
	
 онец‘ункции		//	ƒобавитьЁлемент_Ѕанк()

//******************************************************************************
// ƒобавитьЁлемент_–асчетный—чет(Ёл–одитель, –асчетный—чет)
//		
// ѕараметры:
//	Ёл–одитель		-	XML-Ёлемент
//	–асчетный—чет	-	элемент справочника "Ѕанковские—чета"
//		
// ¬озвращаемое значение:
// 	XML-элемент "–асчетный—чет"
//		
// ќписание
//	ƒобавл€ет XML-элемент "–асчетный—чет" и устанавливает его атрибуты в соответствии со схемой
//		
‘ункци€ ƒобавитьЁлемент_–асчетный—чет(Ёл–одитель, –асчетный—чет)
	
	≈сли ѕустое«начение(–асчетный—чет) = 1 “огда ¬озврат ѕолучитьѕустое«начение()  онец≈сли;
    
	Ёл–асчетный—чет = —оздатьѕодчиненныйЁлемент(Ёл–одитель, "–асчетный—чет");
	                                          
	ƒобавитьЁлемент_Ѕанк(Ёл–одитель.–одитель, –асчетный—чет.Ѕанк);
	ƒобавитьЁлемент_Ѕанк(Ёл–одитель.–одитель, –асчетный—чет.Ѕанкƒл€–асчетов);
	
	ѕроверить»”становитьјтрибут(Ёл–асчетный—чет , "Ќомер—чета",			–асчетный—чет.Ќомер—чета);
	ѕроверить»”становитьјтрибут(Ёл–асчетный—чет , "Ѕанк",				»д(Ёл–асчетный—чет, –асчетный—чет.Ѕанк));
	ѕроверить»”становитьјтрибут(Ёл–асчетный—чет , "Ѕанк орреспондент",	»д(Ёл–асчетный—чет, –асчетный—чет.Ѕанкƒл€–асчетов));
	//ѕроверить»”становитьјтрибут(Ёл–асчетный—чет , " омментарий",		"");
	          
	¬озврат Ёл–асчетный—чет;
	
 онец‘ункции		//	ƒобавитьЁлемент_–асчетный—чет()
    
//******************************************************************************
// ƒобавитьЁлемент_ онтрагент(Ёл–одитель,  онтрагент)
//		
// ѕараметры:
//	Ёл–одитель		-	XML-Ёлемент
//	 онтрагент	-	элемент справочника " онтрагенты"
//		
// ¬озвращаемое значение:
// 	XML-элемент " онтрагент"
//		
// ќписание
//	ƒобавл€ет XML-элемент " онтрагент" и устанавливает его атрибуты в соответствии со схемой
//		
‘ункци€ ƒобавитьЁлемент_ онтрагент(Ёл–одитель,  онтрагент)
	
	≈сли ѕустое«начение( онтрагент) = 1 “огда ¬озврат ѕолучитьѕустое«начение()  онец≈сли;
	
	Ёл онтрагент = —оздатьѕодчиненныйЁлемент(Ёл–одитель, " онтрагент");
	
	”становитьјтрибуты онтрагента(Ёл онтрагент,  онтрагент);
	
	≈сли 		 онтрагент.¬ид() = "‘ирмы" “огда		
		
		ƒобавитьЁлемент_–асчетный—чет(Ёл онтрагент,	—писокјтрибутов.ѕолучить("–асчетный—чет"));
		ƒобавитьЁлемент_ онтакт(Ёл онтрагент,		—писокјтрибутов.ѕолучить(" онтакт"));
		
	 онец≈сли;

	¬озврат Ёл онтрагент;
	
 онец‘ункции		//	ƒобавитьЁлемент_ онтрагент()

//******************************************************************************
// ƒобавитьЁлемент_—клад(Ёл–одитель, —клад)
//		
// ѕараметры:
//	Ёл–одитель	-	XML-Ёлемент
//	—клад		-	элемент справочника "ћеста’ранени€"
//		
// ¬озвращаемое значение:
// 	XML-элемент "—клад"
//		
// ќписание
//	ƒобавл€ет XML-элемент "—клад" и устанавливает его атрибуты в соответствии со схемой
//		
‘ункци€ ƒобавитьЁлемент_—клад(Ёл–одитель, —клад)
                                               
	≈сли ѕустое«начение(—клад) = 1 “огда ¬озврат ѕолучитьѕустое«начение()  онец≈сли;
	
	Ёл—клад = —оздатьѕодчиненныйЁлемент(Ёл–одитель, "—клад");
	
	ѕроверить»”становитьјтрибут(Ёл—клад, "»дентификатор",	»д(Ёл—клад, —клад));
	ѕроверить»”становитьјтрибут(Ёл—клад, "Ќаименование",	—клад.Ќаименование);
	//ѕроверить»”становитьјтрибут(Ёл—клад, "јдрес",			"");
	//ѕроверить»”становитьјтрибут(Ёл—клад, "ќсновной онтакт",	"");	
	//ѕроверить»”становитьјтрибут(Ёл—клад, " омментарий",		—клад. омментарий);
	       
	¬озврат Ёл—клад;
	
 онец‘ункции		//	ƒобавитьЁлемент_—клад()

//******************************************************************************
// ƒобавитьЁлемент_ѕредпри€тие¬ƒокументе(Ёл–одитель,  онтрагент)
//		
// ѕараметры:
//	Ёл–одитель	-	XML-Ёлемент
//	 онтрагент	-	элемент справочника " онтрагенты"
//		
// ¬озвращаемое значение:
// 	XML-элемент "ѕредпри€тие¬ƒокументе"
//		
// ќписание
//	ƒобавл€ет XML-элемент "ѕредпри€тие¬ƒокументе" и устанавливает его атрибуты в соответствии со схемой
//		
‘ункци€ ƒобавитьЁлемент_ѕредпри€тие¬ƒокументе(Ёл–одитель,  онтрагент)
	
	≈сли ѕустое«начение( онтрагент) = 1 “огда ¬озврат ѕолучитьѕустое«начение()  онец≈сли;
	
	ƒобавитьЁлемент_ онтрагент(Ёл–одитель.–одитель,  онтрагент);
	                                            
	//ƒобавитьЁлемент_—клад(Ёл–одитель.–одитель, —писокјтрибутов.ѕолучить("—клад"));
	
	Ёлѕредпри€тие = —оздатьѕодчиненныйЁлемент(Ёл–одитель, "ѕредпри€тие¬ƒокументе");
		
	ѕроверить»”становитьјтрибут(Ёлѕредпри€тие, " онтрагент",	 онтрагент.»дентификатор);
	ѕроверить»”становитьјтрибут(Ёлѕредпри€тие, "–асчетный—чет",	?(ѕустое«начение(—писокјтрибутов.ѕолучить("–асчетный—чет")) = 1, "", —писокјтрибутов.ѕолучить("–асчетный—чет").Ќомер—чета));
	ѕроверить»”становитьјтрибут(Ёлѕредпри€тие, " онтакт",		»д(Ёлѕредпри€тие, —писокјтрибутов.ѕолучить(" онтакт")));
	//ѕроверить»”становитьјтрибут(Ёлѕредпри€тие, "—клад",			»д(Ёлѕредпри€тие, —писокјтрибутов.ѕолучить("—клад")));
	
	ѕроверить»”становитьјтрибут(Ёлѕредпри€тие, "–оль",			—писокјтрибутов.ѕолучить("–оль"));
	                                                                
	¬озврат Ёлѕредпри€тие;
	
 онец‘ункции		//	ƒобавитьЁлемент_ѕредпри€тие¬ƒокументе()

//******************************************************************************
// ƒобавитьЁлемент_ƒополнительный–асход(Ёл–одитель, —умма,  омментарий)
//		
// ѕараметры:
//	Ёл–одитель	-	XML-Ёлемент
//	—умма		-	—умма дополниетельного расхода
//	 омментарий	-	строка - произвольный комментарий
//		
// ¬озвращаемое значение:
// 	XML-элемент "ƒополнительный–асход"
//		
// ќписание
//	ƒобавл€ет XML-элемент "ƒополнительный–асход" и устанавливает его атрибуты в соответствии со схемой
//		
‘ункци€ ƒобавитьЁлемент_ƒополнительный–асход(Ёл–одитель, —умма=0,  омментарий="")

	≈сли ѕустое«начение(—умма) = 1 “огда ¬озврат ѕолучитьѕустое«начение()  онец≈сли;
	
	Ёлƒополнительный–асход = —оздатьѕодчиненныйЁлемент(Ёл–одитель, "ƒополнительный–асход");
		
	ѕроверить»”становитьјтрибут(Ёлƒополнительный–асход, "—умма",		—умма);
	ѕроверить»”становитьјтрибут(Ёлƒополнительный–асход, " омментарий",	 омментарий);
	                                                                
	¬озврат Ёлƒополнительный–асход;
	    
 онец‘ункции		//	ƒобавитьЁлемент_ƒополнительный–асход()

//******************************************************************************
// ƒобавитьЁлемент_—уммаЌалога(Ёл–одитель, »гнорироватьѕустую—умму)
//		
// ѕараметры:
//	Ёл–одитель				-	XML-Ёлемент
//	»гнорироватьѕустую—умму	-	число - (если 1) и (—умма = 1), то 
//		
// ¬озвращаемое значение:
// 	XML-элемент "—уммаЌалога"
//		
// ќписание
//	ƒобавл€ет XML-элемент "—уммаЌалога" и устанавливает его атрибуты в соответствии со схемой
//	если (сумма = 0) » (»гнорироватьѕустую—умму = 0), то элемент не добавл€етс€
//		
‘ункци€ ƒобавитьЁлемент_—уммаЌалога(Ёл–одитель, »гнорироватьѕустую—умму=0)

	≈сли ѕустое«начение(—писокјтрибутов.ѕолучить("Ќалог")) = 1 “огда ¬озврат ѕолучитьѕустое«начение()  онец≈сли;
	≈сли »гнорироватьѕустую—умму = 0 “огда
		≈сли ѕустое«начение(—писокјтрибутов.ѕолучить("—умма")) = 1 “огда ¬озврат ѕолучитьѕустое«начение()  онец≈сли;
	 онец≈сли;
	
	ЁлЌалог = —оздатьѕодчиненныйЁлемент(Ёл–одитель, "—уммаЌалога");
		
	ѕроверить»”становитьјтрибут(ЁлЌалог, "Ќалог",			—писокјтрибутов.ѕолучить("Ќалог"));
	ѕроверить»”становитьјтрибут(ЁлЌалог, "—тавка",			—писокјтрибутов.ѕолучить("—тавка"));
	ѕроверить»”становитьјтрибут(ЁлЌалог, "—умма",			—писокјтрибутов.ѕолучить("—умма"));
	ѕроверить»”становитьјтрибут(ЁлЌалог, "¬ключен¬—умму",	—писокјтрибутов.ѕолучить("¬ключен¬—умму"));
	                                                                
	¬озврат ЁлЌалог;	
	    
 онец‘ункции		//	ƒобавитьЁлемент_—уммаЌалога()

//******************************************************************************
// ƒобавитьЁлемент_ѕредпри€тие¬ƒокументе(Ёл–одитель,  онтрагент)
//		
// ѕараметры:
//	Ёл–одитель	-	XML-Ёлемент
//	 онтрагент	-	элемент справочника " онтрагенты"
//		
// ¬озвращаемое значение:
// 	XML-элемент "ѕредпри€тие¬ƒокументе"
//		
// ќписание
//	ƒобавл€ет XML-элемент "ѕредпри€тие¬ƒокументе" и устанавливает его атрибуты в соответствии со схемой
//		
‘ункци€ »д“овара¬—обственном аталоге(“овар, »дјтрибута»дентификации)
	                                                                
	≈сли »дјтрибута»дентификации <> "Ўтрих од" “огда
		¬озврат( —окрЋѕ(“овар.ѕолучитьјтрибут(»дјтрибута»дентификации)) );
	»наче
		¬озврат( —окрЋѕ(“овар.ќсновна€≈диница.Ўтрих од) );
	 онец≈сли;

 онец‘ункции		//	»д“овара¬—обственном аталоге()

//******************************************************************************
// ѕолучить»д“овараѕо аталогу(“овар,  аталог)
//		
// ѕараметры:
//	“овар	-	товар (—правочник.Ќоменклатура)
//	 аталог	-	 аталог	(—правочник. аталоги)
//		
// ¬озвращаемое значение:
// 	»дентификатор товара в каталоге
//		
// ќписание
//	≈сли каталог наш, 		то	возвращаетс€ значение реквизита идентификации
//	≈сли каталог внешний,	то	возвращаетс€ значение реквизита "»дентификатор¬ аталоге" соответствующего аналога
//
‘ункци€ ѕолучить»д“овараѕо аталогу(“овар,  аталог="")
	                                                
	≈сли ѕустое«начение( аталог) = 1 “огда  аталог =  аталог»дентификации  онец≈сли;
	
	≈сли  аталог.¬ладелец аталога.¬ид() = "‘ирмы" “огда
		¬озврат »д“овара¬—обственном аталоге(“овар, —пособ»дентификации);
	»наче
		—прјналоги = —оздатьќбъект("—правочник.јналоги");
		—прјналоги.»спользовать¬ладельца(“овар);
		≈сли —прјналоги.Ќайтиѕо–еквизиту(" аталог",  аталог, 0) = 0 “огда
			ѕредупреждение("ƒл€ товара " + “овар + " не задан аналог!");
			¬озврат "";
		»наче
			¬озврат —окрЋѕ(—прјналоги.»дентификатор¬ аталоге);
		 онец≈сли;
	 онец≈сли;
	
 онец‘ункции		//	ѕолучить»д“овараѕо аталогу()

//******************************************************************************
// ƒобавить—войство( аталог, ¬ид—войства, ƒобавл€ть—сылку)
//
// ѕараметры:
//   аталог			-	элемент справочника " аталоги"
//	¬ид—войства		-	элемент справочника "¬иды свойств"
//	ƒобавл€ть—сылку	-	число - если 1, то кроме элемента "—войство" будет добавлен также элемент "—сылкаЌа—войство"
//
// ¬озвращаемое значение:
//  Ќет.
//
// ќписание:
//  ƒобавл€ет XML-элемент "—войство" и устанавливает его атрибуты в соответствии со схемой - описание вида свойсства в каталоге
//
ѕроцедура ƒобавить—войство( аталог, ¬ид—войства, ƒобавл€ть—сылку=0)
	
	”жеƒобавлено = Ёл аталог.¬ыбрать”зел("—войство[(@»дентификатор=""" + —окрЋѕ(¬ид—войства.»дентификатор¬ аталоге) +""")]/@Ќаименование");
	            
	≈сли ѕустое«начение(”жеƒобавлено) = 0 “огда ¬озврат  онец≈сли;
	
	Ёл—войство аталога = —оздатьѕодчиненныйЁлемент(Ёл аталог, "—войство");
	
	ѕроверить»”становитьјтрибут(Ёл—войство аталога, "»дентификатор",	¬ид—войства.»дентификатор¬ аталоге);
	ѕроверить»”становитьјтрибут(Ёл—войство аталога, "Ќаименование",		¬ид—войства.Ќаименование);
	ѕроверить»”становитьјтрибут(Ёл—войство аталога, "ћножественность",	¬ид—войства.ћножественность);
                                                                  
	≈сли ƒобавл€ть—сылку = 1 “огда
		Ёл—войство аталога = —оздатьѕодчиненныйЁлемент(Ёл аталог, "—сылкаЌа—войство");
		
		ѕроверить»”становитьјтрибут(Ёл—войство аталога, "»дентификатор аталога",	 аталог.»дентификатор);
		ѕроверить»”становитьјтрибут(Ёл—войство аталога, "»дентификатор—войства",	¬ид—войства.»дентификатор¬ аталоге);
	 онец≈сли;
	
 онецѕроцедуры		//	ƒобавить—войство()

//******************************************************************************
// ƒобавить«начени€—войств(Ёл,  аталог, “ов, —писокќб€зательных—войств)
//
// ѕараметры:
//  Ёл							-	элемент-родитель, дл€ которого добавл€ем значени€ свойств
//	 аталог						-	элемент справочника " аталоги"
//	“ов							-	элемент справочника "Ќоменклатура", - товар, дл€ которого добавл€ем значени€ свойств
//	—писокќб€зательных—войств	-	список значений - об€зательных дл€ заполени€ свойств
//
// ¬озвращаемое значение:
//  Ќет.
//
// ќписание:
//  ƒобавл€ет XML-элемент "«начение—войства" и устанавливает его атрибуты в соответствии со схемой
//
ѕроцедура ƒобавить«начени€—войств(Ёл,  аталог, “ов, —писокќб€зательных—войств="")
	
	—писок«аполненных—войств	=	—оздатьќбъект("—писок«начений");
	        
	»д аталога					=	—окрЋѕ( аталог.»дентификатор);
    —пр«н—войств				=	—оздатьќбъект("—правочник.—войстваЌоменклатуры");
	—пр«н—войств.»спользовать¬ладельца(“ов);
	—пр«н—войств.¬ыбратьЁлементы(1);
	ѕока —пр«н—войств.ѕолучитьЁлемент() = 1 ÷икл
		≈сли —пр«н—войств.ѕометка”далени€() = 1 “огда ѕродолжить  онец≈сли;
		≈сли —пр«н—войств.¬ид—войства. аталог =  аталог “огда
			
			//	ќписание вида св-ва в каталоге
			ƒобавить—войство( аталог, —пр«н—войств.¬ид—войства);
			
			//	«начение св-ва
			»д—войства			= —окрЋѕ(—пр«н—войств.¬ид—войства.»дентификатор¬ аталоге);
			Ёл«начение—войства	= —оздатьѕодчиненныйЁлемент(Ёл, "«начение—войства");
			ѕроверить»”становитьјтрибут(Ёл«начение—войства, "»дентификатор аталога",	»д аталога);
			ѕроверить»”становитьјтрибут(Ёл«начение—войства, "»дентификатор—войства",	»д—войства);
			ѕроверить»”становитьјтрибут(Ёл«начение—войства, "«начение",					—пр«н—войств.«начение—войства.Ќаименование);
			
			//	—сылка на св-во
			«апрос = "—сылкаЌа—войство[(@»дентификатор аталога=""%%%"")and(@»дентификатор—войства=""***"")]";
			«апрос = —тр«аменить(«апрос, "%%%", »д аталога);
			«апрос = —тр«аменить(«апрос, "***", »д—войства);
			
			≈сли ѕустое«начение(Ёл.¬ыбрать”зел(«апрос)) = 1 “огда
				Ёл—сылкаЌа—войство	= —оздатьѕодчиненныйЁлемент(Ёл, "—сылкаЌа—войство");
				ѕроверить»”становитьјтрибут(Ёл—сылкаЌа—войство, "»дентификатор аталога",	»д аталога);
				ѕроверить»”становитьјтрибут(Ёл—сылкаЌа—войство, "»дентификатор—войства",	»д—войства);
			 онец≈сли;
			
			≈сли —писок«аполненных—войств.ѕринадлежит(»д—войства) = 0 “огда
				—писок«аполненных—войств.ƒобавить«начение(»д—войства);
			 онец≈сли;
		 онец≈сли;	
	 онец÷икла;

 онецѕроцедуры		//	ƒобавить«начени€—войств()
            
//******************************************************************************
// ”становитьјтрибуты“овара(Ёл, “ов, Ѕез–одител€)
//
// ѕараметры:
//  Ёл			-	элемент-родитель, у которого устанавливаем атрибуты
//	“ов			-	элемент справочника "Ќоменклатура"
//	Ѕез–одител€	-	число - если 1, то атрибут "–одитель" не устанавливаем
//
// ¬озвращаемое значение:
//  Ќет.
//
// ќписание:
//  ”станавливает атрибуты у переданного элемента "“овар"
//
ѕроцедура ”становитьјтрибуты“овара(Ёл, “ов, Ѕез–одител€=0)
	
	≈сли “ов.Ёто√руппа() = 1 “огда
		»д¬ аталоге = “ов. од;
	»наче
		»д¬ аталоге = ѕолучить»д“овараѕо аталогу(“ов);
	 онец≈сли;
		
	ѕроверить»”становитьјтрибут(Ёл, "»дентификатор",			»д(Ёл, “ов.“екущийЁлемент()));
	ѕроверить»”становитьјтрибут(Ёл, "»дентификатор¬ аталоге",	»д¬ аталоге);
	ѕроверить»”становитьјтрибут(Ёл, "Ќаименование",				“ов.Ќаименование);
	ѕроверить»”становитьјтрибут(Ёл, "–одитель",					?(((ѕустое«начение(“ов.–одитель)=1) »ли (Ѕез–одител€=1)), "", »д(Ёл, “ов.–одитель.“екущийЁлемент())));
	ѕроверить»”становитьјтрибут(Ёл, "≈диница",					“ов.ќсновна€≈диница);
	
 онецѕроцедуры		//	”становитьјтрибуты“овара()
    
//******************************************************************************
// ƒобавить√руппу(Ёл, √руппа)
//
// ѕараметры:
//  Ёл			-	элемент-родитель - " аталог"
//	√руппа		-	группа справочника "Ќоменклатура", которую добавл€ем
//
// ¬озвращаемое значение:
//  Ќет.
//
// ќписание:
//  ƒобавл€ет элемент "√руппа"
//
ѕроцедура ƒобавить√руппу(Ёл, √руппа)
	
	»д√руппы	= »д(Ёл, √руппа.“екущийЁлемент());
	”зел 		= Ёл.¬ыбрать”зел("√руппа[(@»дентификатор=""" + —окрЋѕ(»д√руппы) + """)]");
	
	≈сли ѕустое«начение(”зел) = 0 “огда ¬озврат  онец≈сли;
	
	Ёл√руппа = —оздатьѕодчиненныйЁлемент(Ёл, "√руппа");
	    
	”становитьјтрибуты“овара(Ёл√руппа, √руппа);
	
 онецѕроцедуры		//	ƒобавить√руппу()

//******************************************************************************
// –аскрутить–одителейƒо¬ерхнего”ровн€(Ёл–одитель, √руппа)
//
// ѕараметры:
//  Ёл–одитель	-	элемент-родитель - "“овар" или "√руппа"
//	√руппа		-	группа или элемент  справочника "Ќоменклатура", родителей которой добавл€ем
//
// ¬озвращаемое значение:
//  Ќет.
//
// ќписание:
//  ƒобавл€ет родителей товара или группы вплоть ƒокумент самого верхнего уровн€
//
ѕроцедура –аскрутить–одителейƒо¬ерхнего”ровн€(Ёл–одитель, √руппа)
	
	≈сли ѕустое«начение(√руппа) = 0 “огда
		ƒобавить√руппу(Ёл–одитель, √руппа);
		–аскрутить–одителейƒо¬ерхнего”ровн€(Ёл–одитель, √руппа.–одитель);
	 онец≈сли;
	
 онецѕроцедуры		//	–аскрутить–одителейƒо¬ерхнего”ровн€()

//******************************************************************************
// ƒобавитьЁлемент_“оварна€ѕозици€(Ёл–одитель, ƒокумент)
//		
// ѕараметры:
//	Ёл–одитель	-	XML-элемент
//	ƒокумент	-	спозиционированна€ строка ƒокумента
//		
// ¬озвращаемое значение:
// 	XML-элемент "“оварна€ѕозици€"
//		
// ќписание
//	ƒобавл€ет XML-элемент "“оварна€ѕозици€" и устанавливает его атрибуты в соответствии со схемой
//		
‘ункци€ ƒобавитьЁлемент_“оварна€ѕозици€(Ёл–одитель, ƒокумент)
	
	≈сли ѕустое«начение(ƒокумент) = 1 “огда ¬озврат ѕолучитьѕустое«начение()  онец≈сли;
        
	
	√“ƒ					=	"";
	—транаѕроисхождени€	=	"";
	 омментарий			=	"";
	
	
	Ёл“овар = —оздатьѕодчиненныйЁлемент(Ёл–одитель, "“оварна€ѕозици€");
	
	
	≈сли ƒокумент.¬ид() <> "—чет‘актура¬ыданный" “огда
		
		“овар		=	ƒокумент.Ќоменклатура;
		»д“овара	=	ѕолучить»д“овараѕо аталогу(“овар);
		≈сли ѕустое«начение(»д“овара) = 1 “огда
			—ообщить("“овар:  '" + “овар + "' не идентифицирован по каталогу: " +  аталог»дентификации);
			¬озврат "";
		 онец≈сли;
		
		≈сли гл≈сть–еквизитћн„("ѕарти€", ƒокумент.¬ид()) = 1 “огда
			ѕарти€	=	ƒокумент.ѕарти€;
			≈сли ѕустое«начение(ѕарти€) = 0 “огда
				√“ƒ					=	ѕарти€.√“ƒ;
				—транаѕроисхождени€	=	ѕарти€.—транаѕроисхождени€;
			 онец≈сли;
		 онец≈сли;
		
		≈диница				=	ƒокумент.≈диница.ќ ≈».Ќаименование;
		 омментарий			=	“овар. омментарий;
	»наче
	    √“ƒ					=	ƒокумент.√“ƒ;
		—транаѕроисхождени€	=	ƒокумент.—транаѕроисхождени€;
		»д“овара			=	ƒок.Ќаименование;
		≈диница				=	ƒокумент.≈диница.Ќаименование;
	 онец≈сли;
	
	
	ѕроверить»”становитьјтрибут(Ёл“овар, " аталог",				 аталог»дентификации.»дентификатор);
	ѕроверить»”становитьјтрибут(Ёл“овар, "“овар",				»д“овара);
	ѕроверить»”становитьјтрибут(Ёл“овар, "≈диница",				≈диница);
	ѕроверить»”становитьјтрибут(Ёл“овар, " оличество",			ƒокумент. оличество);
	≈сли ѕустое«начение(ƒокумент. оличество) = 0 “огда
		ѕроверить»”становитьјтрибут(Ёл“овар, "÷ена",			ќкр(ƒокумент.—умма / ƒокумент. оличество, 2, 1));
	 онец≈сли;
	ѕроверить»”становитьјтрибут(Ёл“овар, "—умма",				ƒокумент.—умма);
	ѕроверить»”становитьјтрибут(Ёл“овар, "ќписание",			 омментарий);
	ѕроверить»”становитьјтрибут(Ёл“овар, "—транаѕроисхождени€",	—транаѕроисхождени€);
	ѕроверить»”становитьјтрибут(Ёл“овар, "√“ƒ",					√“ƒ);

	
	≈сли (¬месте— аталогом = 1) » (ƒокумент.¬ид() <> "—чет‘актура¬ыданный") “огда
		–аскрутить–одителейƒо¬ерхнего”ровн€(Ёл аталог, “овар.–одитель);
		≈сли ѕустое«начение(Ёл аталог.¬ыбрать”зел("“овар[@»дентификатор=""" + »д(Ёл аталог, “овар.“екущийЁлемент()) + """]")) = 1 “огда
					//	“акого товара еще не было
			Ёл“овар¬ аталоге = —оздатьѕодчиненныйЁлемент(Ёл аталог, "“овар");
			”становитьјтрибуты“овара(Ёл“овар¬ аталоге, “овар);
			ƒобавить«начени€—войств(Ёл“овар¬ аталоге,  аталог»дентификации, “овар);
		 онец≈сли;
	 онец≈сли;
   	
	
	¬озврат Ёл“овар;
	
 онец‘ункции		//	ƒобавитьЁлемент_“оварна€ѕозици€()

//******************************************************************************
// ƒобавитьЁлемент_ƒокумент(Ёл–одитель, ƒокумент)
//		
// ѕараметры:
//	Ёл–одитель	-	XML-элемент
//	ƒокумент	-	выгружаемый документ
//		
// ¬озвращаемое значение:
// 	XML-элемент "ƒокумент"
//		
// ќписание
//	ƒобавл€ет XML-элемент "ƒокумент" и устанавливает его атрибуты в соответствии со схемой
//		
‘ункци€ ƒобавитьЁлемент_ƒокумент(Ёл–одитель, ƒокумент)
	
	≈сли ѕустое«начение(ƒокумент) = 1 “огда ¬озврат ѕолучитьѕустое«начение()  онец≈сли;
	
	Ёлƒокумент = —оздатьѕодчиненныйЁлемент(Ёл–одитель, "ƒокумент");
		
	ѕроверить»”становитьјтрибут(Ёлƒокумент, "ƒата", 		ƒок.ƒатаƒок			);
	ѕроверить»”становитьјтрибут(Ёлƒокумент, "Ќомер", 		ƒок.Ќомерƒок		);
	ѕроверить»”становитьјтрибут(Ёлƒокумент, "¬рем€", 		ƒок.ѕолучить¬рем€()	);
	ѕроверить»”становитьјтрибут(Ёлƒокумент, " омментарий",	ƒок. омментарий		);
	
	ѕроверить»”становитьјтрибут(Ёлƒокумент, "’озќпераци€",	—писокјтрибутов.ѕолучить("’озќпераци€"));
	ѕроверить»”становитьјтрибут(Ёлƒокумент, "—умма", 		—писокјтрибутов.ѕолучить("—умма"));	
	
	ѕроверить»”становитьјтрибут(Ёлƒокумент, "¬алюта", 		ƒок.¬алюта	);
	ѕроверить»”становитьјтрибут(Ёлƒокумент, " урс",			ƒок. урс	);
	ѕроверить»”становитьјтрибут(Ёлƒокумент, " ратность", 	ƒок.¬алюта. ратность.ѕолучить(ƒок.ƒатаƒок)	);
	
	≈сли гл≈сть–еквизитЎапки("ƒатаќплаты", ƒок.¬ид()) = 1 “огда
		ѕроверить»”становитьјтрибут(Ёлƒокумент, "—рокѕлатежа",	ƒок.ƒатаќплаты);
	 онец≈сли;
	
	¬озврат Ёлƒокумент;
	
 онец‘ункции		//	ƒобавитьЁлемент_ƒокумент()
                                                      
//******************************************************************************
// ƒобавить“овары(Ёлƒокумент)
//		
// ѕараметры:
//	Ёлƒокумент	-	XML-элемент "ƒокумент"
//		
// ¬озвращаемое значение:
// 	Ќет.
//		
// ќписание
//	ѕеребирает строки документа и добавл€ет элементы "“оварна€ѕозици€" и "—уммаЌалога"
//		
‘ункци€ ƒобавить“овары(Ёлƒокумент)
	
	—писокјтрибутов.”далить¬се();
	                   
	ƒок.¬ыбрать—троки();
	ѕока ƒок.ѕолучить—троку() = 1 ÷икл
		Ёл“овар = ƒобавитьЁлемент_“оварна€ѕозици€(Ёлƒокумент, ƒок);
		
		≈сли ѕустое«начение(Ёл“овар) = 1 “огда
			‘лагќшибки = 1;
			¬озврат("");
		 онец≈сли;
		
		—писокјтрибутов.”далить¬се();
		
		≈сли гл≈сть–еквизитЎапки("”читыватьЌƒ—", ƒок.¬ид()) = 1 “огда
			≈сли ƒок.”читыватьЌƒ— = 1 “огда
				—писокјтрибутов.”становить("Ќалог",			"AVT");
				—писокјтрибутов.”становить("—тавка",		глЌачисл€емыйЌƒ—(ƒок.—тавкаЌƒ—)*100 );
				—писокјтрибутов.”становить("—умма",			ƒок.—уммаЌƒ—);
				—писокјтрибутов.”становить("¬ключен¬—умму",	ƒок.—умма¬клЌƒ—);
				
				ƒобавитьЁлемент_—уммаЌалога(Ёл“овар);
			 онец≈сли;
		 онец≈сли;
		       
		
		≈сли гл≈сть–еквизитЎапки("”читыватьЌѕ", ƒок.¬ид()) = 1 “огда
			≈сли ƒок.”читыватьЌѕ = 1 “огда
				—писокјтрибутов.”становить("Ќалог",			"ST");
				—писокјтрибутов.”становить("—тавка",		ƒок.—тавкаЌѕ.—тавка );
				—писокјтрибутов.”становить("—умма",			ƒок.—уммаЌѕ);
				—писокјтрибутов.”становить("¬ключен¬—умму",	ƒок.—умма¬клЌѕ);
				
				ƒобавитьЁлемент_—уммаЌалога(Ёл“овар);
			 онец≈сли;
		 онец≈сли;
		
	 онец÷икла;
	
	¬озврат 1;
    
 онец‘ункции		//	ƒобавить“овары()

//******************************************************************************
// ƒобавить“овары(Ёлƒокумент)
//		
// ѕараметры:
//	Ёлƒокумент	-	XML-элемент "ƒокумент"
//		
// ¬озвращаемое значение:
// 	Ќет.
//		
// ќписание
//	ƒобавл€ет элементы "—уммаЌалога" с итоговыми значени€ми Ќƒ— и Ќѕ
//		
ѕроцедура Ќалоги»того(Ёлƒокумент)
        
	—писокјтрибутов.”далить¬се();
	   
	≈сли гл≈сть–еквизитЎапки("”читыватьЌƒ—", ƒок.¬ид()) = 1 “огда
		≈сли ƒок.”читыватьЌƒ— = 1 “огда
			—писокјтрибутов.”становить("Ќалог",			"AVT");
			—писокјтрибутов.”становить("—тавка",		"0");
			—писокјтрибутов.”становить("—умма",			ƒок.»тог("—уммаЌƒ—"));
			—писокјтрибутов.”становить("¬ключен¬—умму",	ƒок.—умма¬клЌƒ—);
			
			ƒобавитьЁлемент_—уммаЌалога(Ёлƒокумент);
		 онец≈сли;
	 онец≈сли;
           
	≈сли гл≈сть–еквизитЎапки("”читыватьЌѕ", ƒок.¬ид()) = 1 “огда
		≈сли ƒок.”читыватьЌѕ = 1 “огда
			—писокјтрибутов.”становить("Ќалог",			"ST");
			—писокјтрибутов.”становить("—тавка",		"0");
			—писокјтрибутов.”становить("—умма",			ƒок.»тог("—уммаЌѕ"));
			—писокјтрибутов.”становить("¬ключен¬—умму",	ƒок.—умма¬клЌѕ);
			
			ƒобавитьЁлемент_—уммаЌалога(Ёлƒокумент);
		 онец≈сли;
	 онец≈сли;
	
 онецѕроцедуры		//	Ќалоги»того()

//******************************************************************************        
// ƒокумент_¬озвратѕоставщику(Ёл–одитель)
// 
// ѕараметры: 
//  Ёл–одитель - узел создаваемого XML-документа
//
// ¬озвращаемое значение: 
//  Ќет (не используетс€)
//
// ќписание:
// 	¬ыгружает соответствующий документ
//
ѕроцедура ƒокумент_¬озвратѕоставщику(Ёл–одитель)

	—писокјтрибутов.”становить("’озќпераци€", 	?(ƒок. одќперации=гл ќ.¬озвратѕоставщику, "BackSale", "BackComission"));
	—писокјтрибутов.”становить("—умма", 		ƒок.»тог("—умма"));
	
	Ёлƒокумент = ƒобавитьЁлемент_ƒокумент(Ёл–одитель, ƒок);
	
	—писокјтрибутов.”становить("–оль",			"Saler");
	—писокјтрибутов.”становить("–асчетный—чет",	ƒок.‘ирма.ќсновной—чет);
	—писокјтрибутов.”становить("—клад",			"");
	—писокјтрибутов.”становить(" онтакт",		ƒок.‘ирма);
	—писокјтрибутов.”становить(" онтактноеЋицо",	"");
	
	ƒобавитьЁлемент_ѕредпри€тие¬ƒокументе(Ёлƒокумент, ƒок.‘ирма);
	
	—писокјтрибутов.”становить("–оль",			"Buyer");
	—писокјтрибутов.”становить("–асчетный—чет",	"");
	—писокјтрибутов.”становить("—клад",			"");
	—писокјтрибутов.”становить(" онтакт",		"");
	—писокјтрибутов.”становить(" онтактноеЋицо",	"");	
	
	ƒобавитьЁлемент_ѕредпри€тие¬ƒокументе(Ёлƒокумент, ƒок. онтрагент);
	
	Ќалоги»того(Ёлƒокумент);
	                      
	ƒобавить“овары(Ёлƒокумент);
	               
 онецѕроцедуры		//	ƒокумент_¬озвратѕоставщику()

//******************************************************************************        
// ƒокумент_–еализаци€(Ёл–одитель)
// 
// ѕараметры: 
//  Ёл–одитель - узел создаваемого XML-документа
//
// ¬озвращаемое значение: 
//  Ќет (не используетс€)
//
// ќписание:
// 	¬ыгружает соответствующий документ
//
ѕроцедура ƒокумент_–еализаци€(Ёл–одитель)
	
	—писокјтрибутов.”становить("’озќпераци€", 	?(ƒок. одќперации=гл ќ.ѕродажа, "Sale", "Comission"));
	—писокјтрибутов.”становить("—умма", 			ƒок.»тог("—умма"));
	
	Ёлƒокумент = ƒобавитьЁлемент_ƒокумент(Ёл–одитель, ƒок);
	
	—писокјтрибутов.”становить("–оль",			"Saler");
	—писокјтрибутов.”становить("–асчетный—чет",	ƒок.‘ирма.ќсновной—чет);
	//—писокјтрибутов.”становить("—клад",			ƒок.—клад);
	—писокјтрибутов.”становить(" онтакт",		ƒок.‘ирма);	
	—писокјтрибутов.”становить(" онтактноеЋицо",	"");	
	
	ƒобавитьЁлемент_ѕредпри€тие¬ƒокументе(Ёлƒокумент, ƒок.‘ирма);
	
	—писокјтрибутов.”становить("–оль",			"Buyer");
	—писокјтрибутов.”становить("–асчетный—чет",	"");
	—писокјтрибутов.”становить("—клад",			"");
	—писокјтрибутов.”становить(" онтакт",		"");
	—писокјтрибутов.”становить(" онтактноеЋицо",	"");	
	
	ƒобавитьЁлемент_ѕредпри€тие¬ƒокументе(Ёлƒокумент, ƒок. онтрагент);
	
	Ќалоги»того(Ёлƒокумент);
	
	ƒобавить“овары(Ёлƒокумент);
    
 онецѕроцедуры		//	ƒокумент_–еализаци€()

//******************************************************************************        
// ƒокумент_ќтчет омитенту(Ёл–одитель)
// 
// ѕараметры: 
//  Ёл–одитель - узел создаваемого XML-документа
//
// ¬озвращаемое значение: 
//  Ќет (не используетс€)
//
// ќписание:
// 	¬ыгружает соответствующий документ
//
ѕроцедура ƒокумент_ќтчет омитенту(Ёл–одитель)
	    
	–ег–еализованный“овар	=	—оздатьќбъект("–егистр.–еализованный“овар");
	
	—писокјтрибутов.”становить("’озќпераци€", 		"ReportComission");
	            
	»тогоЌƒ—			=	0;
	ѕрод—тоимость		=	0;
	–ег–еализованный“овар.¬ыбратьƒвижени€ƒокумента(ƒок);
	ѕока –ег–еализованный“овар.ѕолучитьƒвижение() = 1 ÷икл
		ѕрод—тоимость	=	ѕрод—тоимость + –ег–еализованный“овар.ѕрод—тоимость - –ег–еализованный“овар.¬ознаграждение;
	 онец÷икла;
	    
	—писокјтрибутов.”становить("—умма",	глѕересчет(ѕрод—тоимость, гл–убли, 1, ƒок.¬алюта, ƒок. урс));
	
	
	Ёлƒокумент = ƒобавитьЁлемент_ƒокумент(Ёл–одитель, ƒок);
	
	—писокјтрибутов.”становить("–оль",				"Payer");			//	плательщик
	—писокјтрибутов.”становить("–асчетный—чет",		ƒок.‘ирма.ќсновной—чет);
	—писокјтрибутов.”становить(" онтакт",			ƒок.‘ирма);	
	—писокјтрибутов.”становить(" онтактноеЋицо",	"");	
	
	ƒобавитьЁлемент_ѕредпри€тие¬ƒокументе(Ёлƒокумент, ƒок.‘ирма);
	
	—писокјтрибутов.”становить("–оль",				"Recipient");		//	получатель
	—писокјтрибутов.”становить("–асчетный—чет",		"");
	—писокјтрибутов.”становить("—клад",				"");
	—писокјтрибутов.”становить(" онтакт",			"");
	—писокјтрибутов.”становить(" онтактноеЋицо",	"");	
	
	ƒобавитьЁлемент_ѕредпри€тие¬ƒокументе(Ёлƒокумент, ƒок. онтрагент);
	
	
	// ƒобавл€ем товары
	
		—писокјтрибутов.”далить¬се();
		–ег–еализованный“овар.¬ыбратьƒвижени€ƒокумента(ƒок);
		ѕока –ег–еализованный“овар.ѕолучитьƒвижение() = 1 ÷икл
			Ёл“овар = —оздатьѕодчиненныйЁлемент(Ёлƒокумент, "“оварна€ѕозици€");
			            
			√“ƒ					=	"";
			—транаѕроисхождени€	=	"";
			 омментарий			=	"";
			“овар				=	–ег–еализованный“овар.Ќоменклатура;
			»д“овара			=	ѕолучить»д“овараѕо аталогу(“овар);
			≈сли ѕустое«начение(»д“овара) = 1 “огда
				—ообщить("“овар:  '" + “овар + "' не идентифицирован по каталогу: " +  аталог»дентификации);
				¬озврат;
			 онец≈сли;
			
			ѕарти€	=	–ег–еализованный“овар.ѕарти€;
			≈сли ѕустое«начение(ѕарти€) = 0 “огда
				√“ƒ					=	ѕарти€.√“ƒ;
				—транаѕроисхождени€	=	ѕарти€.—транаѕроисхождени€;
			 онец≈сли;
			
			≈диница				=	“овар.Ѕазова€≈диница.ќ ≈».Ќаименование;
			 омментарий			=	“овар. омментарий;
			 оличество			=	–ег–еализованный“овар. оличество;
			—умма				=	–ег–еализованный“овар.ѕрод—тоимость - –ег–еализованный“овар.¬ознаграждение;
			÷ена				=	?( оличество <> 0, —умма /  оличество, 0);
			
			ѕроверить»”становитьјтрибут(Ёл“овар, " аталог",				 аталог»дентификации.»дентификатор);
			ѕроверить»”становитьјтрибут(Ёл“овар, "“овар",				»д“овара);
			ѕроверить»”становитьјтрибут(Ёл“овар, "≈диница",				≈диница);
			ѕроверить»”становитьјтрибут(Ёл“овар, " оличество",			 оличество);
			ѕроверить»”становитьјтрибут(Ёл“овар, "÷ена",				глѕересчет(÷ена,  гл–убли, 1, ƒок.¬алюта, ƒок. урс));
			ѕроверить»”становитьјтрибут(Ёл“овар, "—умма",				глѕересчет(—умма, гл–убли, 1, ƒок.¬алюта, ƒок. урс));
			ѕроверить»”становитьјтрибут(Ёл“овар, "ќписание",			 омментарий);
			ѕроверить»”становитьјтрибут(Ёл“овар, "—транаѕроисхождени€",	—транаѕроисхождени€);
			ѕроверить»”становитьјтрибут(Ёл“овар, "√“ƒ",					√“ƒ);
			
			≈сли ¬месте— аталогом = 1 “огда
				–аскрутить–одителейƒо¬ерхнего”ровн€(Ёл аталог, “овар.–одитель);
				≈сли ѕустое«начение(Ёл аталог.¬ыбрать”зел("“овар[@»дентификатор=""" + »д(Ёл аталог, “овар.“екущийЁлемент()) + """]")) = 1 “огда
							//	“акого товара еще не было
					Ёл“овар¬ аталоге = —оздатьѕодчиненныйЁлемент(Ёл аталог, "“овар");
					”становитьјтрибуты“овара(Ёл“овар¬ аталоге, “овар);
					ƒобавить«начени€—войств(Ёл“овар¬ аталоге,  аталог»дентификации, “овар);
				 онец≈сли;
			 онец≈сли;
			
			—писокјтрибутов.”далить¬се();
			
			—тавка		=	глЌачисл€емыйЌƒ—(“овар.—тавкаЌƒ—);
			—уммаЌƒ—	=	—умма - (—умма / (1 + —тавка));
			»тогоЌƒ—	=	»тогоЌƒ— + —уммаЌƒ—;
			
			—писокјтрибутов.”становить("Ќалог",			"AVT");
			—писокјтрибутов.”становить("—тавка",		—тавка * 100 );
			—писокјтрибутов.”становить("—умма",			глѕересчет(—уммаЌƒ—, гл–убли, 1, ƒок.¬алюта, ƒок. урс));
			—писокјтрибутов.”становить("¬ключен¬—умму",	"1");
			ƒобавитьЁлемент_—уммаЌалога(Ёл“овар);
					
		 онец÷икла;
		
	//	—уммаЌƒ— »того
	
		—писокјтрибутов.”далить¬се();
		—писокјтрибутов.”становить("Ќалог",			"AVT");
		—писокјтрибутов.”становить("—тавка",		"0");
		—писокјтрибутов.”становить("—умма",			глѕересчет(»тогоЌƒ—, гл–убли, 1, ƒок.¬алюта, ƒок. урс));
		—писокјтрибутов.”становить("¬ключен¬—умму",	"1");
		ƒобавитьЁлемент_—уммаЌалога(Ёлƒокумент);
    
 онецѕроцедуры		//	ƒокумент_ќтчет омитенту()

//******************************************************************************        
// ƒокумент_«аказѕоставщику(Ёл–одитель)
// 
// ѕараметры: 
//  Ёл–одитель - узел создаваемого XML-документа
//
// ¬озвращаемое значение: 
//  Ќет (не используетс€)
//
// ќписание:
// 	¬ыгружает соответствующий документ
//
ѕроцедура ƒокумент_«аказѕоставщику(Ёл–одитель)
	
	—писокјтрибутов.”становить("’озќпераци€", 	"Order");
	—писокјтрибутов.”становить("—умма", 			ƒок.»тог("—умма"));
	
	Ёлƒокумент = ƒобавитьЁлемент_ƒокумент(Ёл–одитель, ƒок);
	                              
	—писокјтрибутов.”становить("–оль",			"Buyer");
	—писокјтрибутов.”становить("–асчетный—чет",	"");
	—писокјтрибутов.”становить("—клад",			"");
	—писокјтрибутов.”становить(" онтакт",		ƒок.‘ирма);
	—писокјтрибутов.”становить(" онтактноеЋицо",	"");	
	
	ƒобавитьЁлемент_ѕредпри€тие¬ƒокументе(Ёлƒокумент, ƒок.‘ирма);
	
	—писокјтрибутов.”становить("–оль",			"Saler");
	—писокјтрибутов.”становить("–асчетный—чет",	"");
	—писокјтрибутов.”становить("—клад",			"");
	—писокјтрибутов.”становить(" онтакт",		"");
	—писокјтрибутов.”становить(" онтактноеЋицо",	"");	
	
	ƒобавитьЁлемент_ѕредпри€тие¬ƒокументе(Ёлƒокумент, ƒок. онтрагент);
	
	Ќалоги»того(Ёлƒокумент);
	
	ƒобавить“овары(Ёлƒокумент);
	
 онецѕроцедуры		//	ƒокумент_«аказѕоставщику()

//******************************************************************************        
// ƒокумент_«а€вкаѕокупател€(Ёл–одитель)
// 
// ѕараметры: 
//  Ёл–одитель - узел создаваемого XML-документа
//
// ¬озвращаемое значение: 
//  Ќет (не используетс€)
//
// ќписание:
// 	¬ыгружает соответствующий документ
//
ѕроцедура ƒокумент_«а€вкаѕокупател€(Ёл–одитель)
	
	—писокјтрибутов.”становить("’озќпераци€", 	"PayableBill");
	—писокјтрибутов.”становить("—умма", 			ƒок.»тог("—умма"));
	
	Ёлƒокумент = ƒобавитьЁлемент_ƒокумент(Ёл–одитель, ƒок);
	
	—писокјтрибутов.”становить("–оль",			"Saler");
	—писокјтрибутов.”становить("–асчетный—чет",	ƒок.Ѕанковский—чет);
	—писокјтрибутов.”становить("—клад",			"");
	—писокјтрибутов.”становить(" онтакт",		ƒок.‘ирма);
	—писокјтрибутов.”становить(" онтактноеЋицо",	"");	
	
	ƒобавитьЁлемент_ѕредпри€тие¬ƒокументе(Ёлƒокумент, ƒок.‘ирма);
	
	—писокјтрибутов.”становить("–оль",			"Buyer");
	—писокјтрибутов.”становить("–асчетный—чет",	"");
	—писокјтрибутов.”становить("—клад",			"");
	—писокјтрибутов.”становить(" онтакт",		"");
	—писокјтрибутов.”становить(" онтактноеЋицо",	"");	
	
	ƒобавитьЁлемент_ѕредпри€тие¬ƒокументе(Ёлƒокумент, ƒок. онтрагент);

	Ќалоги»того(Ёлƒокумент);

	ƒобавить“овары(Ёлƒокумент);
	
 онецѕроцедуры		//	ƒокумент_«а€вкаѕокупател€()

//******************************************************************************        
// ƒокумент_—чет‘актура¬ыданный(Ёл–одитель)
// 
// ѕараметры: 
//  Ёл–одитель - узел создаваемого XML-документа
//
// ¬озвращаемое значение: 
//  Ќет (не используетс€)
//
// ќписание:
// 	¬ыгружает соответствующий документ
//
ѕроцедура ƒокумент_—чет‘актура¬ыданный(Ёл–одитель)
	
	—писокјтрибутов.”становить("’озќпераци€", 	"Invoice");
	//—писокјтрибутов.”становить("—умма", 		ƒок.»тог("—умма"));
	—писокјтрибутов.”становить("—умма", 		0);
	
	Ёлƒокумент = ƒобавитьЁлемент_ƒокумент(Ёл–одитель, ƒок);
	
	—писокјтрибутов.”становить("–оль",			"Saler");
	—писокјтрибутов.”становить("–асчетный—чет",	ƒок.‘ирма.ќсновной—чет);
	—писокјтрибутов.”становить("—клад",			"");
	—писокјтрибутов.”становить(" онтакт",		ƒок.‘ирма);
	—писокјтрибутов.”становить(" онтактноеЋицо",	"");	
	
	ƒобавитьЁлемент_ѕредпри€тие¬ƒокументе(Ёлƒокумент, ƒок.‘ирма);
	
	—писокјтрибутов.”становить("–оль",			"Buyer");
	—писокјтрибутов.”становить("–асчетный—чет",	"");
	—писокјтрибутов.”становить("—клад",			"");
	—писокјтрибутов.”становить(" онтакт",		"");
	—писокјтрибутов.”становить(" онтактноеЋицо",	"");	
	
	ƒобавитьЁлемент_ѕредпри€тие¬ƒокументе(Ёлƒокумент, ƒок. онтрагент);
                    
	ƒокќснование	=	ƒок.ƒокќснование;
	                                     
	≈сли ѕустое«начение(ƒокќснование) = 0 “огда
		ƒок = ƒокќснование;
	 онец≈сли;
	
	Ќалоги»того(Ёлƒокумент);
	ƒобавить“овары(Ёлƒокумент);
	ѕроверить»”становитьјтрибут(Ёлƒокумент, "—умма", ƒок.»тог("—умма"));
	
	
 онецѕроцедуры		//	ƒокумент_—чет‘актура¬ыданный()

//******************************************************************************        
// ƒокумент_– ќ(Ёл–одитель)
// 
// ѕараметры: 
//  Ёл–одитель - узел создаваемого XML-документа
//
// ¬озвращаемое значение: 
//  Ќет (не используетс€)
//
// ќписание:
// 	¬ыгружает соответствующий документ
//
ѕроцедура ƒокумент_– ќ(Ёл–одитель)
	
	—писокјтрибутов.”становить("’озќпераци€", 	?(ƒок. одќперации=гл ќ.¬озвратќплатыѕокупателю, "BackCash", "Cash"));
	—писокјтрибутов.”становить("—умма", 			ƒок.—умма);
	
	Ёлƒокумент = ƒобавитьЁлемент_ƒокумент(Ёл–одитель, ƒок);
	
	—писокјтрибутов.”становить("–оль",			"Payer");
	—писокјтрибутов.”становить("–асчетный—чет",	"");
	—писокјтрибутов.”становить("—клад",			"");
	—писокјтрибутов.”становить(" онтакт",		ƒок.‘ирма);
	—писокјтрибутов.”становить(" онтактноеЋицо",	"");	
	
	ƒобавитьЁлемент_ѕредпри€тие¬ƒокументе(Ёлƒокумент, ƒок.‘ирма);
	
	—писокјтрибутов.”становить("–оль",			"Recipient");
	—писокјтрибутов.”становить("–асчетный—чет",	"");
	—писокјтрибутов.”становить("—клад",			"");
	—писокјтрибутов.”становить(" онтакт",		"");
	—писокјтрибутов.”становить(" онтактноеЋицо",	"");	
	
	ƒобавитьЁлемент_ѕредпри€тие¬ƒокументе(Ёлƒокумент, ƒок. онтрагент);

	//—писокјтрибутов.”становить("Ќалог",			"AVT");
	//—писокјтрибутов.”становить("—тавка",			—тавкаЌалога(, "Ќƒ—"));
	//—писокјтрибутов.”становить("—умма",			"0");
	//—писокјтрибутов.”становить("¬ключен¬—умму",	"");
	//
	//ƒобавитьЁлемент_—уммаЌалога(Ёлƒокумент);
	//
	//—писокјтрибутов.”становить("Ќалог",			"ST");
	//—писокјтрибутов.”становить("—тавка",			—тавкаЌалога(, "Ќѕ"));
	//—писокјтрибутов.”становить("—умма",			"0");
	//—писокјтрибутов.”становить("¬ключен¬—умму",	"");
	//
	//ƒобавитьЁлемент_—уммаЌалога(Ёлƒокумент);
	
 онецѕроцедуры		//	ƒокумент_– ќ()

//******************************************************************************        
// ƒокумент_—трока¬ыписки–асход(Ёл–одитель)
// 
// ѕараметры: 
//  Ёл–одитель - узел создаваемого XML-документа
//
// ¬озвращаемое значение: 
//  Ќет (не используетс€)
//
// ќписание:
// 	¬ыгружает соответствующий документ
//
ѕроцедура ƒокумент_—трока¬ыписки–асход(Ёл–одитель)
	
	—писокјтрибутов.”становить("’озќпераци€", 	?(ƒок. одќперации=гл ќ.¬озвратќплатыѕокупателю, "BackPayment", "Payment"));
	—писокјтрибутов.”становить("—умма", 			ƒок.—умма);
    
	Ёлƒокумент = ƒобавитьЁлемент_ƒокумент(Ёл–одитель, ƒок);
	
	—писокјтрибутов.”становить("–оль",			"Payer");
	—писокјтрибутов.”становить("–асчетный—чет",	ƒок.Ѕанковский—чет);
	—писокјтрибутов.”становить("—клад",			"");
	—писокјтрибутов.”становить(" онтакт",		ƒок.‘ирма);
	—писокјтрибутов.”становить(" онтактноеЋицо",	"");	
	
	ƒобавитьЁлемент_ѕредпри€тие¬ƒокументе(Ёлƒокумент, ƒок.‘ирма);
	
	—писокјтрибутов.”становить("–оль",			"Recipient");
	—писокјтрибутов.”становить("–асчетный—чет",	"");
	—писокјтрибутов.”становить("—клад",			"");
	—писокјтрибутов.”становить(" онтакт",		"");
	—писокјтрибутов.”становить(" онтактноеЋицо",	"");	
	
	ƒобавитьЁлемент_ѕредпри€тие¬ƒокументе(Ёлƒокумент, ƒок. онтрагент);

 онецѕроцедуры		//	ƒокумент_—трока¬ыписки–асход()

//******************************************************************************
// ¬ыгрузитьƒокумент()
//		
// ѕараметры:
//	Ёл–одитель	-	XML-элемент (корневой)
//		
// ¬озвращаемое значение:
// 	Ќет.
//		
// ќписание
//	¬ зависимости от вида документа вызывает нужную процедуру
//		
ѕроцедура ¬ыгрузитьƒокумент(Ёл–одитель)
	
	—писокјтрибутов.”далить¬се();
	
	¬ид	= ƒок.¬ид();
	
	≈сли		¬ид = "«аказѕоставщику"			“огда	ƒокумент_«аказѕоставщику(Ёл–одитель);
	»наче≈сли	¬ид = "«а€вкаѕокупател€"		“огда	ƒокумент_«а€вкаѕокупател€(Ёл–одитель);
	»наче≈сли	¬ид = "–еализаци€"				“огда	ƒокумент_–еализаци€(Ёл–одитель);
	»наче≈сли	¬ид = "¬озвратѕоставщику"		“огда	ƒокумент_¬озвратѕоставщику(Ёл–одитель);
	»наче≈сли	¬ид = "—чет‘актура¬ыданный"		“огда	ƒокумент_—чет‘актура¬ыданный(Ёл–одитель);
	»наче≈сли	¬ид = "– ќ"						“огда	ƒокумент_– ќ(Ёл–одитель);
	»наче≈сли	¬ид = "—трока¬ыписки–асход"		“огда	ƒокумент_—трока¬ыписки–асход(Ёл–одитель);
	»наче≈сли	¬ид = "ќтчет омитенту"			“огда	ƒокумент_ќтчет омитенту(Ёл–одитель);
	 онец≈сли;
	          
 онецѕроцедуры		//	¬ыгрузитьƒокумент()


////////////////////////////////////////////////////////////////////////////////
// ѕ–≈ƒќѕ–≈ƒ≈Ћ≈ЌЌџ≈ ѕ–ќ÷≈ƒ”–џ
// 
//****************************************************************************** 
//	ѕредопределенна€ процедура
ѕроцедура ѕриќткрытии()
	
	—татус¬озврата(0);
	         
	—писокјтрибутов		=	—оздатьќбъект("—писок«начений");
	
	—писокѕараметров	=	‘орма.ѕараметр;
	     
	≈сли		ѕустое«начение(—писокѕараметров) = 1				“огда	¬озврат;
	»наче≈сли	“ип«начени€—тр(—писокѕараметров) = "ƒокумент"	“огда	¬озврат;
	»наче
		»м€‘айла			= —писокѕараметров.ѕолучить("ѕолное»м€‘айла");
		ƒок					= —писокѕараметров.ѕолучить("ƒокумент");
		 аталог»дентификации	= —писокѕараметров.ѕолучить(" аталог");
		¬месте— аталогом		= —писокѕараметров.ѕолучить("‘л¬ыгружать аталог");
	 онец≈сли;
	     
	≈сли		ѕустое«начение( аталог»дентификации) = 1 “огда
		—пособ»дентификации	=	" од";
	»наче≈сли	ѕустое«начение( аталог»дентификации.—пособ»дентификацииЌоменклатуры) = 1 “огда
		—пособ»дентификации	=	" од";
	»наче
		—пособ»дентификации	=	 аталог»дентификации.—пособ»дентификацииЌоменклатуры.»дентификатор();
	 онец≈сли;

	≈сли «агрузить¬нешнюю омпоненту( аталог»Ѕ() + "v7plus.dll") <> 1 “огда
		≈сли «агрузить¬нешнюю омпоненту( аталог»Ѕ() + "ExtForms\" + "v7plus.dll") <> 1 “огда		
			≈сли «агрузить¬нешнюю омпоненту( аталогѕрограммы() + "v7plus.dll") <> 1 “огда
				ѕредупреждение(" омпонента v7plus.dll не найдена!");
				¬озврат;
			 онец≈сли;	
		 онец≈сли;
	 онец≈сли;
	
	јнализатор		= —оздатьќбъект("AddIn.XMLParser");
	
	XMLƒокумент		= јнализатор.—оздатьƒокумент();
	
	≈сли ѕустое«начение(XMLƒокумент) = 1 “огда	¬озврат  онец≈сли;
	
	
	XMLƒокумент.«агрузить»з—троки("<?xml version =""1.0""?><BizTalk xmlns = ""urn:schemas-biztalk-org:biztalk/biztalk-0.81.xml""><Route><From locationID = """" locationType = """" process = """" path = """" handle = """"/><To locationID = """" locationType = """" process = """" path = """" handle = """"/></Route><Body/></BizTalk>");
	
	 оллекци€—хем		=	јнализатор.—оздать оллекцию—хем();
	 оллекци€—хем.ƒобавить—хему("urn:CommerceML",  аталог»Ѕ() + "ExtForms\CommerML.biz");
	XMLƒокумент.—хемы	=	 оллекци€—хем;
                         
	//	—оздаем корневой элемент
	Ёл омм»нфо			=	—оздатьѕодчиненныйЁлемент(XMLƒокумент.Ёлементƒокумента.¬ыбрать”зел("Body"), " оммерческа€»нформаци€");
	
	≈сли ¬месте— аталогом = 1 “огда
		Ёл аталог		=	—оздатьѕодчиненныйЁлемент(Ёл омм»нфо, " аталог");
		”становитьјтрибуты аталога(Ёл аталог);
	 онец≈сли;
	
	‘лагќшибки = 0;
	
	¬ыгрузитьƒокумент(Ёл омм»нфо);
	             
	≈сли ‘лагќшибки = 1 “огда ¬озврат  онец≈сли;

	//XMLƒокумент.ѕроверить();		// проверка полученного докумета на соответствие схеме CommerML.biz
	                              
	≈сли ѕустое«начение(»м€‘айла) = 1 “огда
		»м€‘айла =  аталог»Ѕ() + —окрЋѕ(ƒок.Ќомерƒок) + ".xml";
		≈сли ‘с.¬ыбрать‘айл(1, »м€‘айла,  аталог»Ѕ(), "¬ыберите файл выгрузки", "*.xml|*.xml", , ) = 0 “огда ¬озврат  онец≈сли;
	 онец≈сли;
	
	XMLƒокумент.«аписать(»м€‘айла);	
	
 онецѕроцедуры		//	ѕриќткрытии()

//******************************************************************************





