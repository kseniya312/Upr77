//*******************************************
Процедура Выполнить()
	Перем СтавкаНДС;
    
	Если Вопрос("Внимание! Эта обработка во время своего выполнения, не позволит другим пользователям"+РазделительСтраниц
				+"проводить документы, создавать новые элементы и др. действия... Вы уверены, что хотите запустить её?",4,10)<>6 
	тогда
		возврат;
	конецЕсли;
	
	
начатьТранзакцию();

	Док=СоздатьОбъект("Документ.Реализация");
	Док.ВыбратьДокументы(НачДата, КонДата);
	Пока Док.ПолучитьДокумент()=1 Цикл
		сообщить("Обрабатываем документ: "+сокрЛП(Док));
		Док.ВыбратьСтроки();
		Если глЕстьРеквизитМнЧ("СуммаНДСбезСкидки",Док.Вид())=1 Тогда
			Пока Док.ПолучитьСтроку()=1 Цикл
				БазаНалога=Док.СуммаБезСкидки;
				СтавкаНДС = ?(Док.УчитыватьНДС=1,Док.СтавкаНДС, Перечисление.СтавкиНДС.БезНДС);	//расчёт по каждой строке
				Если Док.СуммаВклНДС=1 Тогда
					Док.СуммаНДСбезСкидки=БазаНалога*глВыделяемыйНДС(СтавкаНДС);//0.1667, 0.16666(6),...
				Иначе
					Док.СуммаНДСбезСкидки=БазаНалога*глНачисляемыйНДС(СтавкаНДС);//0.20, 0.20004...
				КонецЕсли;
			КонецЦикла;
		КонецЕсли;
		Док.Записать();
		Если Док.Проведен()=1 тогда
			Док.Провести();
		конецЕсли;
	КонецЦикла;
зафиксироватьТранзакцию();

КонецПроцедуры
