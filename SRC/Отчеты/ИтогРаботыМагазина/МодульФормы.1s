Перем ИтогоПродано, ИтогоПроданоПоБезналу , ИтогоВозвращено, ИтогоВыданоПроцентов, ИтогоПогашеноКредитов;
Перем ИтогоПроданоЧ,ИтогоПроданоПоБезналуЧ, ИтогоВозвращеноЧ, ИтогоВыданоПроцентовЧ, ИтогоПогашеноКредитовЧ;

Процедура Продано()
	Перем Запрос, ТекстЗапроса;
	//Создание объекта типа Запрос
	Запрос = СоздатьОбъект("Запрос");
	ТекстЗапроса = 
	"//{{ЗАПРОС(Продано)
	|Период с (НачДата) по (КонДата);
	|Обрабатывать НеПомеченныеНаУдаление;
	|СкладВыдачи = Документ.РасходнаяНакладнаяРозница.Склад;
	|Сумма = Документ.РасходнаяНакладнаяРозница.Сумма, Документ.РасходнаяНакладнаяРозница.СуммаНДС;
	|Функция СуммаСумма = Сумма(Сумма);
	|Условие(СкладВыдачи в Склад);
	|"//}}ЗАПРОС
	;
	// Если ошибка в запросе, то выход из процедуры
	Если Запрос.Выполнить(ТекстЗапроса) = 0 Тогда
		Возврат;
	КонецЕсли;
	ИтогоПродано="Итого было продано на сумму: "+глФРМ(Запрос.СуммаСумма,глРубли);
	ИтогоПроданоЧ=Запрос.СуммаСумма;
КонецПроцедуры  
 //by Зад
Процедура ПроданоПоБезналу()
	Перем Запрос, ТекстЗапроса;
	//Создание объекта типа Запрос
	Запрос = СоздатьОбъект("Запрос");
	ТекстЗапроса = 
	"//{{ЗАПРОС(ПроданоПоБезналу)
	|Период с (НачДата) по (КонДата);
	|Обрабатывать НеПомеченныеНаУдаление;
	|СкладВыдачи = Документ.РасходнаяНакладнаяРозницаБезнал.Склад;
	|Сумма = Документ.РасходнаяНакладнаяРозницаБезнал.Сумма, Документ.РасходнаяНакладнаяРозницаБезнал.СуммаНДС;
	|Функция СуммаСумма = Сумма(Сумма);
	|Условие(СкладВыдачи в Склад);
	|"//}}ЗАПРОС
	;
	// Если ошибка в запросе, то выход из процедуры
	Если Запрос.Выполнить(ТекстЗапроса) = 0 Тогда
		Возврат;
	КонецЕсли;
	ИтогоПроданоПоБезналу  = "Итого было продано по безналу на сумму: " +глФРМ(Запрос.СуммаСумма,глРубли);
	ИтогоПроданоПоБезналуЧ = Запрос.СуммаСумма;
КонецПроцедуры
    //by Зад





Процедура Возвращено()
	Перем Запрос, ТекстЗапроса;
	//Создание объекта типа Запрос
	Запрос = СоздатьОбъект("Запрос");
	ТекстЗапроса = 
	"//{{ЗАПРОС(Возвращено)
	|Период с (НачДата) по (КонДата);
	|Обрабатывать НеПомеченныеНаУдаление;
	|СкладВыдачи = Документ.ВозвратОтПокупателя_Розница.Склад;
	|Сумма = Документ.ВозвратОтПокупателя_Розница.Сумма, Документ.ВозвратОтПокупателя_Розница.СуммаНДС;
	|Функция СуммаСумма = Сумма(Сумма);
	|Условие(СкладВыдачи в Склад);
	|"//}}ЗАПРОС
	;
	// Если ошибка в запросе, то выход из процедуры
	Если Запрос.Выполнить(ТекстЗапроса) = 0 Тогда
		Возврат;
	КонецЕсли;
	ИтогоВозвращено="Итого было возвращено на сумму: "+глФРМ(Запрос.СуммаСумма,глРубли);
	ИтогоВозвращеноЧ=Запрос.СуммаСумма;
КонецПроцедуры  

Процедура ВыданоПроцентов()
	Перем Запрос, ТекстЗапроса;
	//Создание объекта типа Запрос
	Запрос = СоздатьОбъект("Запрос");
	ТекстЗапроса = 
	"//{{ЗАПРОС(Продано)
	|Период с (НачДата) по (КонДата);
	|Обрабатывать НеПомеченныеНаУдаление;
	|СкладВыдачи = Документ.ВыплатаПроцентов_Розница.Склад_выдачи;
	|Сумма = Документ.ВыплатаПроцентов_Розница.Сумма; 
	|Функция СуммаСумма = Сумма(Сумма);
	|Условие(СкладВыдачи в Склад);
	|"//}}ЗАПРОС
	;
	// Если ошибка в запросе, то выход из процедуры
	Если Запрос.Выполнить(ТекстЗапроса) = 0 Тогда
		Возврат;
	КонецЕсли;
	ИтогоВыданоПроцентов="Итого было выдано процентов на сумму: "+глФРМ(Запрос.СуммаСумма,глРубли);
	ИтогоВыданоПроцентовЧ=Запрос.СуммаСумма;
КонецПроцедуры
Процедура ПогашеноКредитов()
	Перем Запрос, ТекстЗапроса;
	//Создание объекта типа Запрос
	Запрос = СоздатьОбъект("Запрос");
	ТекстЗапроса = 
	"//{{ЗАПРОС(Продано)
	|Период с (НачДата) по (КонДата);
	|Обрабатывать НеПомеченныеНаУдаление;
	|СкладВыдачи = Документ.ВозвратДолгов_Розница.Склад_выдачи;
	|Сумма = Документ.ВозвратДолгов_Розница.Сумма; 
	|Функция СуммаСумма = Сумма(Сумма);
	|Условие(СкладВыдачи в Склад);
	|"//}}ЗАПРОС
	;
	// Если ошибка в запросе, то выход из процедуры
	Если Запрос.Выполнить(ТекстЗапроса) = 0 Тогда
		Возврат;
	КонецЕсли;
	ИтогоПогашеноКредитов="Итого было погашено кредитов на сумму: "+глФРМ(Запрос.СуммаСумма,глРубли);
	ИтогоПогашеноКредитовЧ=Запрос.СуммаСумма;
КонецПроцедуры

//Собирает данные по всем движениям в магазине
Процедура Сформировать()
	Продано();
	ПроданоПоБезналу() ;
	Возвращено();
	ВыданоПроцентов();
	ПогашеноКредитов();
	
	ИтогоВНаличииЧ		= ИтогоПроданоЧ + ИтогоПроданоПоБезналуЧ  -ИтогоВозвращеноЧ - ИтогоВыданоПроцентовЧ;
	ИтогоВНаличии		= "Итого в наличии: "+глФРМ(ИтогоВНаличииЧ, глРубли);
	
	ИтогоФинРезультат	= "Итого фин. результат: "+ глФРМ(ИтогоВНаличииЧ+ИтогоПогашеноКредитовЧ, глРубли);
	
	Таб = СоздатьОбъект("Таблица");
	Таб.ИсходнаяТаблица("Таблица");
	Таб.ВывестиСекцию("Заголовок");
	Состояние("Заполнение выходной таблицы...");
	Таб.Опции(0, 0, Таб.ВысотаТаблицы(), 0);
	Таб.ВывестиСекцию("Итого");
	// Вывод заполненной формы
	Таб.ТолькоПросмотр(1);
	Таб.Показать("Сводный финансовый отчёт", "");
КонецПроцедуры  
