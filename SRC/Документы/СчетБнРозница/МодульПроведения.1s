Процедура ОбработкаПроведения(ВидыДвижений)
                                                                                       
	СписокРекв = СоздатьОбъект("СписокЗначений");
	Если глПроверитьСовпадениеРеквизитовСчетаСЗаявкой(ТекущийДокумент(), СписокРекв) = 0 Тогда
		колРекв = СписокРекв.РазмерСписка();
		СообщениеСписРекв = "";
		Пока колРекв <> 0 Цикл
			СообщениеСписРекв = СообщениеСписРекв + СписокРекв.ПолучитьЗначение(колРекв) + РазделительСтрок;
			колРекв = колРекв - 1;
		КонецЦикла;
		
		глНеПроводить(Контекст,"Не совпадают реквизиты счета с реквизитами заявки." + РазделительСтрок + СообщениеСписРекв);	
	КонецЕсли;	
	
	//}}ДВИЖЕНИЯ_РЕГИСТРОВ

	//Данный фрагмент построен конструктором.
	//При повторном использовании конструктора, внесенные вручную изменения будут потеряны!!!
    
	ВыбратьСтроки();
	Пока ПолучитьСтроку() = 1 Цикл
		Регистр.РезервыРозницы.КредДокумент = ТекущийДокумент();
		Регистр.РезервыРозницы.Номенклатура = Номенклатура;
		Регистр.РезервыРозницы.Количество 	= Количество;
		Регистр.РезервыРозницы.СуммаРуб 	= Сумма;
		Регистр.РезервыРозницы.ДвижениеПриходВыполнить();
	КонецЦикла;
	//}}ДВИЖЕНИЯ_РЕГИСТРОВ

	Регистр.Покупатели_Розница.Контрагент		 			= Контрагент;
	Регистр.Покупатели_розница.ВидВзаимодействия 			= Перечисление.ВидВзаимодействия.Оплата;
	Регистр.Покупатели_Розница.Магазин			 			= Склад;
	Регистр.Покупатели_Розница.АналитикаСчетБезнал		 	= АналитикаСчетБезналПроценты; 
	Регистр.Покупатели_Розница.СуммаРуб 		 			= Итог("Сумма")+?(СуммаВклНП=1,0,Итог("СуммаНП"))+?(СуммаВклНДС=1,0,Итог("СуммаНДС"));     
	Регистр.Покупатели_Розница.ДвижениеПриходВыполнить();     
	
	ТекСумма = Итог("Сумма")+?(СуммаВклНП=1,0,Итог("СуммаНП"))+?(СуммаВклНДС=1,0,Итог("СуммаНДС"));
	          
	Если (ДатаДок >= дата("01.03.2017")) или (ПровестиПереносОплаты = 1) Тогда
		Регистр.ПереносОплаты.Контрагент 					= АналитикаСчетБезналПроценты.КонтрагентЮЛ;
		Регистр.ПереносОплаты.СчетБезнал		 			= АналитикаСчетБезналПроценты;
		Регистр.ПереносОплаты.СуммаОплаты 		 			= ТекСумма;
		Регистр.ПереносОплаты.СуммаОтгрузки		 			= ТекСумма;
		Регистр.ПереносОплаты.ДвижениеПриходВыполнить();    
	КонецЕсли;
	
КонецПроцедуры //ОбработкаПроведения()
