Процедура ПриОткрытии()
	Форма.ИспользоватьЗакладки(1);
	Форма.Закладки.ДобавитьЗначение("Документы склада");			//1
	Форма.Закладки.ДобавитьЗначение("Заявки на склад");				//2
	Форма.Закладки.ДобавитьЗначение("Заявки на склад (опт)");		//3
	Форма.Закладки.ДобавитьЗначение("Заявки на склад (розн.)");		//4
	Форма.Закладки.ДобавитьЗначение("Заявки на склад (перем.)");	//5
	Форма.Закладки.ДобавитьЗначение("Реализация");					//6
	
	выбСклад=глПользователь.ОсновнойСклад;
	Форма.ДатаСоздания.Видимость(0);
КонецПроцедуры

Процедура ПриИзмененииСклада()
	если выбСклад="" Тогда
		УстановитьОтбор(,);
	Иначе
		УстановитьОтбор("ДокументСклада",выбСклад);
	КонецЕсли;
КонецПроцедуры

Функция ПолучитьПиктограмму(Режим)	//Режим отображения иконки
	Если Режим = 1  Тогда
		если ТекущийДокумент.Вид()="ПеремещениеТМЦ_Розница" Тогда
			Если ТекущийДокумент.Набран=1 Тогда
				Выплатили=1;
			Иначе
				Выплатили=2;
			КонецЕсли;
		ИначеЕсли ТекущийДокумент.Вид()="ПоступлениеТМЦ" Тогда
			Если ТекущийДокумент.Набран=1 Тогда
				Выплатили=1;
			Иначе
				Выплатили=2;
			КонецЕсли;
		ИначеЕсли ТекущийДокумент.Вид()="ЗаявкаПокупателя" Тогда
			Если ТекущийДокумент.ВидОперации = Перечисление.ВидыОперацийЗаявок.НаСклад Тогда
				Если ТекущийДокумент.ЗаявкаВзятаВРаботу = 1 Тогда
					Выплатили = 1;
				Иначе
					Выплатили = 0;
				КонецЕсли;
			КонецЕсли;	
		Иначе
			Выплатили=0;
		КонецЕсли;
		Возврат Выплатили;
	иначеесли режим=2 Тогда
		Если ТекущийДокумент.Вид()="ПоступлениеТМЦ" Тогда
			Если пустоезначение(ТекущийДокумент.Принят_к_учету)=0 Тогда
				Выплатили=1;
			Иначе
				Выплатили=2;
			КонецЕсли;
		ИначеЕсли ТекущийДокумент.Вид()="ПеремещениеТМЦ_Розница" Тогда
			Если пустоезначение(ТекущийДокумент.Принят_к_учету)=0 Тогда
				Выплатили=1;
			Иначе
				Выплатили=2;
			КонецЕсли;
		ИначеЕсли ТекущийДокумент.Вид()="ЗаявкаПокупателя" Тогда
			Если ТекущийДокумент.ВидОперации = Перечисление.ВидыОперацийЗаявок.НаСклад Тогда
				Если (ТекущийДокумент.ЗаявкаПеремещена = 1) Тогда
					Выплатили = 1;
				Иначе
					//Проверим есть ли проведенное перемещение в розницу*************************************
					//если есть установим признак "Перемещено"***********************************************
					Если ТекущийДокумент.ДокОснование.Вид() = "ЗаявкаКлиентаРозница" Тогда
						ДокПодч			= СоздатьОбъект("Документ");
						Выплатили = 0;
						ДокПодч.ВыбратьПодчиненныеДокументы(,,ТекущийДокумент);
						Пока ДокПодч.ПолучитьДокумент()=1 Цикл
							Если (ДокПодч.Вид() = "ПеремещениеТМЦ_Розница") Тогда
								Если (ДокПодч.ПометкаУдаления() = 0) и (ДокПодч.Проведен() = 1) Тогда
									Выплатили = 1;
									Прервать;
								КонецЕсли;	
							КонецЕсли;
						КонецЦикла;
					КонецЕсли;
					//***************************************************************************************
				КонецЕсли;
			КонецЕсли;		
		Иначе
			Выплатили=0;
		КонецЕсли;
		Возврат Выплатили; 
	иначеесли режим=3 Тогда
		Если ТекущийДокумент.Вид()="ЗаявкаПокупателя" Тогда
			Если  ТекущийДокумент.ЗаявкаОбработана = 1 Тогда
				Если  ТекущийДокумент.Итог("Количество") = ТекущийДокумент.Итог("КоличествоФакт") Тогда
					Возврат  1; 
				Иначе
					Возврат  2; 
				КонецЕсли;	
			Иначе
				Выплатили = 0;
			КонецЕсли;		
		Иначе
			Выплатили=0;
		КонецЕсли;
		Возврат Выплатили;
	КонецЕсли;
КонецФункции

Процедура ПриВыбореЗакладки(Номер)
	Форма.ДатаСоздания.Видимость(1);
	Если Номер = 1  Тогда
		УстановитьОтбор("ДокументСклада",выбСклад);
		Форма.ДатаСоздания.Видимость(0);
	ИначеЕсли Номер = 2  Тогда
		//Форма.ИспользоватьСлой("Основной,Склад", 2);
		УстановитьОтбор("ВидЗаявки",Перечисление.ВидыОперацийЗаявок.НаСклад);
	ИначеЕсли Номер = 3  Тогда //опт
		//Форма.ИспользоватьСлой("Основной,Склад", 2);
		проба		= СоздатьОбъект("Справочник.ОтборРознДокум");
		ЭР = сокрЛП(Перечисление.ВидыОперацийЗаявок.НаСклад)+"Опт";
		Если проба.НайтиПоНаименованию(сокрЛП(ЭР),0,1)=1 Тогда
			Отб			= проба.ТекущийЭлемент();
		Иначе
			Отб			= "";
		КонецЕсли;
		УстановитьОтбор("ВидТипДокументаРозницаБезСклада",Отб);
	ИначеЕсли Номер = 4  Тогда //розн.
		//Форма.ИспользоватьСлой("Основной,Склад", 2);
		проба		= СоздатьОбъект("Справочник.ОтборРознДокум");
		ЭР = сокрЛП(Перечисление.ВидыОперацийЗаявок.НаСклад)+"Розница";
		Если проба.НайтиПоНаименованию(сокрЛП(ЭР),0,1)=1 Тогда
			Отб			= проба.ТекущийЭлемент();
		Иначе
			Отб			= "";
		КонецЕсли;
		УстановитьОтбор("ВидТипДокументаРозницаБезСклада",Отб);
	ИначеЕсли Номер = 5  Тогда //перем.
		//Форма.ИспользоватьСлой("Основной,Склад", 2);
		проба		= СоздатьОбъект("Справочник.ОтборРознДокум");
		ЭР = сокрЛП(Перечисление.ВидыОперацийЗаявок.НаСклад)+"Перемещение";
		Если проба.НайтиПоНаименованию(сокрЛП(ЭР),0,1)=1 Тогда
			Отб			= проба.ТекущийЭлемент();
		Иначе
			Отб			= "";
		КонецЕсли;
		УстановитьОтбор("ВидТипДокументаРозницаБезСклада",Отб);
	ИначеЕсли Номер = 6  Тогда                   
		УстановитьОтбор("Реализация");
		Форма.ДатаСоздания.Видимость(0);
		//Форма.Сумма.Видимость(0);                   
		//Форма.СуммаРеализации.Видимость(1);
		//Форма.ЭкспортБух.Видимость(1);
	КонецЕсли;
КонецПроцедуры	


